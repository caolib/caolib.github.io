<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>mysql | 学海无涯</title><meta name="keywords" content="数据库,mysql"><meta name="author" content="caolibin"><meta name="copyright" content="caolibin"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="mysql"><meta name="application-name" content="mysql"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="mysql"><meta property="og:url" content="https://clibin.gitee.io/2023/07/28/mysql/index.html"><meta property="og:site_name" content="学海无涯"><meta property="og:description" content="MySQL执行编写顺序-- 语句编写和执行顺序select    -- 4    字段列表from    -- 1    表名列表where    -- 2    条件列表group by --3    分组字段列表having         分组后条件列表order by --5    排序字段"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://img2.imgtp.com/2024/04/26/wBGeLSLD.png"><meta property="article:author" content="caolibin"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://img2.imgtp.com/2024/04/26/wBGeLSLD.png"><meta name="description" content="MySQL执行编写顺序-- 语句编写和执行顺序select    -- 4    字段列表from    -- 1    表名列表where    -- 2    条件列表group by --3    分组字段列表having         分组后条件列表order by --5    排序字段"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="https://clibin.gitee.io/2023/07/28/mysql/"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="B68nszCBTyPYshqosfiYmpXO-kEDYDP-yAaADQej-m4"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: undefined,
  diytitle: {"enable":true,"leaveTitle":"别肘,快回来！","backTitle":"♪(^∇^*)！"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: 'https://clibin-twikoo-comments.hf.space',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":10000,"accessToken":"911b527c61f5ff2539b8f9e1c112ce7d","mailMd5":""},
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: {"appId":"5XB6D5PJUB","apiKey":"07997253594a9ada0ae49be2e2983b26","indexName":"hexo","hits":{"per_page":6},"languages":{"input_placeholder":"输入关键词后按下回车查找","hits_empty":"找不到您查询的内容：${query}","hits_stats":"找到 ${hits} 条结果，用时 ${time} 毫秒"}},
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: caolibin","link":"链接: ","source":"来源: 学海无涯","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#282C34","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '学海无涯',
  title: 'mysql',
  postAI: '',
  pageFillDescription: 'MySQL, 执行编写顺序, 一、数据定义语言DDL, 1、数据库操作, 2、表操作, 二、 DML（增删改）, insert update delete, 三、DQL（查）, 1、select from, 2、where, 3、count、max、group, 4、order by, 5、案例, 四、 DCL, 五、 函数, 1、字符串函数, 2、数值函数, 3、日期函数, 4、流程控制函数, 案例, 六、约束, 1、基础约束, 2、外键约束, 1、增、删外键, 2、删除、更新行为, 七、多表查询, 1、概述, 2、连接查询, 内连接, 外连接, 自连接, union查询, 3、子查询, 标量子查询, 列子查询, 行子查询, 表子查询, 4、多表查询案例, 八、事务, 1、事务简介, 2、事务操作, 3、事务的四大特性（ACID）, 4、并发事务问题, 5、隔离级别, 九、JDBC, 1、jdbc7步编程, 2、DriverManager, 3、Connection, 4、Statement, 5、ResultSet, 6、用户登陆, 7、PrepareStatement, 8、Druid数据库连接池, 十、进阶, 1、索引, 2、SQL优化执行编写顺序语句编写和执行顺序字段列表表名列表条件列表分组字段列表分组后条件列表排序字段列表分页参数一数据定义语言数据库操作数据库操作显示所有数据库数据库名创建数据库数据库名使用数据库显示当前在哪个数据库下数据库名删库跑路表操作表操作显示所有表表名字段字段类型字段字段类型创建表表名查看表中所有字段表名添加字段修改字段类型修改字段名及类型删除字段修改表名表名删除表二增删改插入一条语句男男插入多条语句男男男男查看表修改把为的全部改为小黑子小黑子把为的改为鸡哥性别改为女鸡哥女把所有人的年龄改为删除为小黑子的人小黑子删除所有人三查创建表并插入数据编号工号姓名性别年龄身份证号工作地址入职时间员工表插入数据柳岩女北京张无忌男北京韦一笑男上海赵敏女北京小昭女上海杨逍男北京范瑶男北京黛绮丝女天津范凉凉女北京陈友谅男上海张士诚男江苏常遇春男北京张三丰男江苏灭绝女西安胡青牛男西安周芷若女北京基本查询查询指定字段返回查询返回所有字段也可以查询所有字段但实际使用中不建议因为不明确查询所有员工的工作地址并起一个别名可以省略工作地址查询所有员工的工作地址并去除重复地址上班地址条件查询查询年龄为的员工查询年龄小于的员工查询没有身份证号码的员工查询有身份证号码的员工查询年龄不等于的员工查询年龄在到两端都包含之间的员工小的在前面大的在后面否则什么都查不到查询性别为女且年龄小于的员工女查询年龄或等于或或的员工查询名字为两个字的员工的信息模糊匹配对应单个字符对应多个字符查询身份证号最后一位是的员工这样不太好查询身份证号倒数第九位是的员工聚合函数最大最小平均值整列数据加起来统计整列数据的个数作用于列所有聚合函数不参与的计算统计企业员工数量因为有一个员工的身份证号码为统计所有员工的平均年龄查询最大的年龄查询最小的年龄统计西安地区员工年龄之和西安分组查询条件根据性别分组分别统计男女人数根据什么字段分组就查询什么字段查询其他字段无意义此处表示每组的数量根据性别分组分别统计男女平均年龄查询年龄小于的员工并根据工作地址分组获取员工数量大于等于的工作地址后面也接条件与不同的是对分组后的数据进行操作可以对聚合函数进行判断不行执行顺序聚合函数分组后查询字段一般为聚合函数或分组字段因为查询其他字段无意义排序查询根据年龄对员工进行排序升序排序默认升序排序降序排序根据入职时间对员工进行降序排序根据年龄升序排序若年龄相同根据入职时间降序排序分页查询把所有数据一页一页展示出来起始索引查询的个数起始索引页码数每页展示数分页查询是的方言不同的数据库语言有不同的实现查询第页员工数据查询个数为第一页的其实索引可以省略查询第页员工数据查询个数为不足条则全部显示案例案例查询年龄为岁的员工信息查询性别为男并且年龄在岁含以内的姓名为三个字的员工男统计员工表中年龄小于岁的男性员工和女性员工的人数查询所有年龄小于等于岁员工的姓名和年龄并对查询结果按年龄升序排序如果年龄相同按入职时间降序排序查询性别为男且年龄在岁含以内的员工信息对查询的结果按年龄升序排序年龄相同按入职时间升序排序取前个员工信息男四创建用户创建用户只能在当前主机访问密码是创建用户能在任意主机访问数据库密码为通配符修改密码为删除用户查询权限给用户授予对数据库中所有表操作的所有权限撤销对数据库中所有表操作的所有权限五函数字符串函数字符串函数拼接字符串字符串全部小写字符串全部大写左填充中间的参数表示字符串的长度最后参数表示以什么字符填充右填充参数同上去除字符串头尾的空格截取字符串此处表示截取从索引开始截取字符串长度为的子串注意这个索引是从开始的数值函数数值函数向上取整只要小数位不是就加向下取整模取余数生成之间的随机数四舍五入保留位数对四舍五入保留位小数案例生成一个位数的随机验证码日期函数日期函数返回当前日期返回当前时间返回当前时间和日期分别获取年月日指定日期加上一定时间后的日期及时间从现在往后推天从现在往前推年返回两个日期之间相差的天数前面的日期后面的日期从我生日到现在多少天了案例查询所有员工入职天数并按照降序排序入职天数入职天数流程控制函数返回返回类似于三目运算符如果不为返回为返回注意空字符串不是查询员工姓名和工作地址条件北京上海一线城市其他二线城市北京一线城市上海一线城市二线城市工作地址案例案例统计班级各个学生的成绩展示规则如下优秀及格否则不及格编号姓名数学英语语文成绩表优秀及格不及格数学优秀及格不及格英语优秀及格不及格语文六约束基础约束主键主键随插入的数据自动增加无需插入姓名不能为空唯一的其他行不能出现重复年龄条件必须满足中的条件状态没有指定时的默认值性别用户表插入数据为主键无需插入插入也没用会自动更正男男男插入的不能为报错男插入的不能重复报错虽然没有成功但是已经申请到主键所以会空出一个主键男男插入的年龄超出的范围报错男不插入插入数据后值默认为外键约束增删外键外键约束准备数据准备两张表并插入数据部门名称部门表研发部市场部财务部销售部总经办主键姓名年龄工作工资入职时间直属领导部门员工表金庸总裁张无忌项目经理杨逍开发韦一笑开发常遇春开发小昭程序员鼓励师添加外键给表的添加外键约束关联表的主键变为的主表外键名删除外键删除更新行为删除更新行为添加外键在父表中删除更新外键记录外键数据时检查是否有外键若有则子表中的数据也相应的删除更新通俗父表删除或更新外键子表只要有与父表相关的外键那么子表也跟着更新或删除删除研发部的外键后表中所有对应研发部的员工都会被删除添加外键通俗父表删除或更新外键子表只要有与父表相关的外键那么子表直接设置为七多表查询概述创建表并插入数据部门名称部门表研发部市场部财务部销售部总经办人事部创建表并插入数据姓名年龄职位薪资入职时间直属领导部门员工表添加外键金庸总裁张无忌项目经理杨逍开发韦一笑开发常遇春开发小昭程序员鼓励师灭绝财务总监周芷若会计丁敏君出纳赵敏市场部总监鹿杖客职员鹤笔翁职员方东白职员张三丰销售总监俞莲舟销售宋远桥销售陈友谅多表查询笛卡尔积集合与集合所有的组合的情况通过条件消除多余的笛卡尔积连接查询内连接查询两张表中符合条件的数据不符合条件的不会返回结果内连接演示查询员工姓名并查询关联部门的名称隐式内连接实现表结构条件给表起别名起了别名后不能用原名查询员工姓名并查询关联部门的名称显式内连接实现可以省略后面接条件表结构条件外连接左外连接查询左表所有数据和右表中符合条件的数据右外连接查询左表所有数据和右表中符合条件的数据外连接演示表结构条件左外连接查询左表所有数据和右左表相交的数据可以省略后面接条件查询所有员工信息和对应部门信息查询右表所有数据和左右表相交的数据左外连接和右外连接可以互相转化表的顺序换一下就行了习惯上左外连接自连接自连接自连接时要给表起别名用于区分哪张表表结构内自连接查询员工及其所属领导的名字外自连接查询员工及其所属领导的名字没有领导也要查询出来员工领导查询联合查询将薪资低于和年龄大于的员工全部查询出来相当于把两张表直接加起来所以有可能有重复的员工对结果去重查询的列数必须相同字段类型也必须相同子查询标量子查询标量子查询后一个查询的结果为单个值常用操作符查询销售部所有员工信息先查询销售部门销售部根据销售部门查出员工信息销售部查询在方东白入职之后的员工信息方东白列子查询列子查询查询销售部和市场部的所有员工信息先查询销售部和市场部的销售部市场部根据查询员工信息销售部市场部查询工资比财务部所有员工工资都高的员工查询财务部所有人的工资财务部根据上述信息查询比财务部所有人工资都高的员工财务部大于后面查询到的所有数据查询比研发部至少一人工资高的员工任意一人研发部至少存在一个人的工资比我低研发部研发部和等同行子查询行子查询查询与张无忌薪资和直属领导相同的员工信息查询张无忌的薪资和直属领导张无忌查询与张无忌薪资和直属领导相同的员工信息张无忌表子查询表子查询查询和鹿杖客宋远桥职位和薪资相同的员工信息查询鹿杖客宋远桥的职位和薪资鹿杖客宋远桥查询和鹿杖客宋远桥职位和薪资相同的员工信息鹿杖客宋远桥查询入职时间是之后的员工及其部门信息查询入职时间是之后的员工查询这些员工的部门信息把上述查询的结果当做需要查询的一张表多表查询案例多表查询案例准备数据薪资等级表查询员工的姓名年龄职位部门信息查询年龄小于岁的员工姓名年龄职位部门信息查询拥有员工的部门部门名称查询所有年龄大于岁的员工及其归属的部门名称如果员工没有分配部门也需要展示出来查询所有员工的工资等级查询研发部所有员工的信息及工资等级研发部研发部查询研发部员工的平均工资研发部查询工资比灭绝高的员工信息子查询灭绝自查询灭绝查询比平均薪资高的员工信息查询低于本部门平均工资的员工信息查询某部门平均薪资查询低于本部门平均工资的员工信息查询所有的部门信息并统计部门的员工人数查询所有部门信息统计号部门员工数量查询所有的部门信息并统计部门的员工人数人数八事务事务简介事务是一组操作的集合它是一个不可分割的工作单位事务会把所有的操作作为一个整体一起向系统提交或撤销操作请求即这些操作要么同时成功要么同时失败事务操作事务准备数据姓名余额账户表张三李四恢复数据操作张三李四查询事务提交方式手动自动方式一设置为手动提交转账操作张三转给李四元查询张三余额张三张三余额张三若此处出现异常则张三元但李四并没有元异常模拟出错场景李四余额李四提交事务回滚事务方式二设置为自动提交转账操作张三转给李四元查询张三余额张三张三余额张三若此处出现异常则张三元但李四并没有元异常模拟出错场景李四余额李四提交事务回滚事务事务的四大特性原子性事务是不可分割的最小操作单元要么全部成功要么全部失败一致性事务完成时必须使所有的数据都保持一致状态一致性事务完成时必须使所有的数据都保持一致状态隔离性数据库系统提供的隔离机制保证事务在不受外部并发操作影响的独立环境下运行持久性事务一旦提交或回滚它对数据库中的数据的改变就是永久的并发事务问题脏读一个事务读取到另外一个事务未提交的数据不可重复读一个事务先后读取同一条数据但两次读取到的数据不同幻读一个事务查询数据时没有对应数据插入该数据时又发现该数据已经存在好像出现幻影隔离级别并发事务与隔离级别查询事务隔离级别设置事务隔离级别仅当前页面起作用事务隔离级别是默认级别隔离级别越高数据越安全但是性能越低九步编程快速入门注册驱动获取连接定义获取执行的对象执行受影响的行数处理结果受影响的行数有行释放资源注册驱动可以省略获取连接如果连接的是本机的数据库且端口是默认的则可以简写简写定义获取执行的对象执行受影响的行数处理结果受影响的行数有行释放资源有两个作用注册驱动获取数据库连接管理事务开启事务将自动提交改为手动执行处理结果受影响的行数有行制造异常执行处理结果受影响的行数有行提交事务回滚事务执行语句执行语句执行语句注册驱动获取连接定义获取执行的对象执行处理结果修改成功修改失败释放资源执行语句注册驱动获取连接定义获取执行的对象执行处理结果修改成功修改失败释放资源执行查询语句注册驱动获取连接定义语句获取对象执行处理数据遍历中的所有数据光标向下移动一行判断当前行是否有数据获取数据获取数据释放资源查询数据库中表的数据封装成对象并存储到表中定义实体类查询数据封装数据到表中注册驱动获取连接定义语句获取对象执行获取数据释放资源用户登陆用户登陆注册驱动获取连接接收用户名和密码获取对象执行语句判断是否登陆成功登陆成功登陆失败释放资源注入问题注册驱动获取连接接收用户名和密码注入此处密码错误却还能成功登陆获取对象执行语句判断是否登陆成功登陆成功登陆失败释放资源解决注入问题将语句中的敏感符号加进行转义注册驱动获取连接开启预编译功能性能更高接收用户名和密码注入此处密码错误却还能成功登陆定义语句获取对象设置的值执行语句判断是否登陆成功登陆成功登陆失败释放资源数据库连接池数据库连接池导入包定义配置文件加载配置文件获取连接池对象获取数据库连接配置文件根据具体情况配置初始化连接数量最大连接数量最大等待时间秒十进阶索引索引查询表中所有索引创建索引索引名表名字段名给表中字段创建常规索引给表中字段创建唯一索引给表中创建联合索引字段的顺序是有讲究的给表中字段创建常规索引删除索引索引名表名性能分析查看各种语句的执行频率慢查询日志查询语句执行时间超过指定时间默认秒就会记录到慢查询日志详情查看是否支持查看是否开启未开启开启开启查看所有查询语句耗时情况查看指定查询语句的各个阶段的耗时额外查看语句消耗执行计划索引的使用最左前缀法则最左边的索引必须存在否则索引全部失效如果跳过了某个索引那么从该索引开始的后面字段的索引失效没有跳过索引索引全部生效软件工程软件工程软件工程跳过最左边的索引索引全部失效跳过索引后面的索引失效前面的索引正常软件工程查询语句的条件的位置不影响索引是否生效没有跳过任何索引索引全部生效软件工程出现范围查询时后面的索引失效使用不会软件工程索引运算不要在索引上进行运算否则索引失效字符串字段查询时不加单引号索引失效没用单引号索引失效模糊匹配后面加模糊匹配索引正常前面模糊索引失效软件索引有效工程连接的条件只有两个条件都有索引索引才会生效否则失效解决方法建立相关字段的索引有索引但是没有索引索引失效和都有索引索引生效数据分布影响如果评估使用索引比全表更慢则放弃索引大部分数据都符合条件时会出现这种情况所有电话号码都大于使用全表扫描使用了索引具体使用索引还是不使用索引取决表中的数据符合条件的数据多不用少用未使用索引提示是优化数据库的一个重要手段就是在语句中加入一些人为的提示达到优化操作的目的查询一个字段时如果同时存在单列索引和联合索引默认使用联合索引有两个索引默认使用的是联合索引软件工程建议使用这个索引至于用不用取决于软件工程忽略索引指定不会使用该索引软件工程强制使用指定必须使用该索引可能并不接受强制使用优化优化插入优化批量插入手动控制事务主键顺序插入指令下载进阶篇相关脚本主键优化尽量降低主键的长度插入数据时尽量使用顺序插入尽量不要使用或者其他自然主键尽量不对主键进行修改优化效率低效率高索引的顺序升序降序创建和字段的一个联合索引根据索引查询结果不需要再进行排序两个条件都是倒序使用倒序扫描先对排序再根据排序不符合最左前缀法则先对升序再对降序排序优化创建升序降序的索引默认是升序尽量避免使用否则需要所有字段都建立了联合索引才能走索引否则就是不可避免使用时可以适当增大排序文件缓冲区大小优化覆盖索引加子查询的形式优化效率主键字段优化更新的数据最好有索引否则执行语句时行锁会升级为表锁并发性能降低',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-04-26 13:43:37',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const now = new Date()
          const hour = now.getHours()
          const isNight = hour <= 6 || hour >= 18
          if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
          else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/self/onedark.css"><link rel="stylesheet" href="/self/one-light-theme.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@docsearch/css@3"/></pre></li><script src="https://sdk.51.la/perf/js-sdk-perf.min.js" crossorigin="anonymous"></script><script>new LingQue.Monitor().init({id:"3IEsVRMsUqe5mGFc"});</script><meta name="generator" content="Hexo 7.2.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://s2.loli.net/2024/06/02/wuJknzxaFigDSdL.gif"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="anzhiyufont anzhiyu-icon-grip-vertical"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">其他线路</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://clb.pages.dev" title="cloudflare"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/cloudflare.svg" alt="cloudflare"/><span class="back-menu-item-text">cloudflare</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.netlify.app" title="netlify"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/netlify.svg" alt="netlify"/><span class="back-menu-item-text">netlify</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.github.io" title="github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/github.svg" alt="github"/><span class="back-menu-item-text">github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.vercel.app" title="vercel"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/vercel.svg" alt="vercel"/><span class="back-menu-item-text">vercel</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">我</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/caolib" title="github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/github.svg" alt="github"/><span class="back-menu-item-text">github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/clibin" title="gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/gitee.svg" alt="gitee"/><span class="back-menu-item-text">gitee</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">学海无涯</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>var WIDGET = {
  "CONFIG": {
    "modules": "0124",
    "background": "2",
    "tmpColor": "FFFFFF",
    "tmpSize": "16",
    "cityColor": "FFFFFF",
    "citySize": "16",
    "aqiColor": "E8D87B",
    "aqiSize": "16",
    "weatherIconSize": "24",
    "alertIconSize": "18",
    "padding": "10px 10px 10px 10px",
    "shadow": "0",
    "language": "auto",
    "borderRadius": "20",
    "fixed": "true",
    "vertical": "top",
    "horizontal": "left",
    "left": "20",
    "top": "7.1",
    "key": "df245676fb434a0691ead1c63341cd94"
  }
}
</script><link rel="stylesheet" href="https://widget.qweather.net/simple/static/css/he-simple.css?v=1.4.0"/><script src="https://widget.qweather.net/simple/static/js/he-simple.js?v=1.4.0"></script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span> 搜索</span></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="微信" src="/null"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/null" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="/null"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/NOSQL/" style="font-size: 1.05rem;">NOSQL<sup>1</sup></a><a href="/tags/apifox/" style="font-size: 1.05rem;">apifox<sup>1</sup></a><a href="/tags/axios/" style="font-size: 1.05rem;">axios<sup>1</sup></a><a href="/tags/c/" style="font-size: 1.05rem;">c++<sup>1</sup></a><a href="/tags/everything/" style="font-size: 1.05rem;">everything<sup>1</sup></a><a href="/tags/gateway/" style="font-size: 1.05rem;">gateway<sup>1</sup></a><a href="/tags/git/" style="font-size: 1.05rem;">git<sup>1</sup></a><a href="/tags/java/" style="font-size: 1.05rem;">java<sup>2</sup></a><a href="/tags/jwt/" style="font-size: 1.05rem;">jwt<sup>1</sup></a><a href="/tags/linux/" style="font-size: 1.05rem;">linux<sup>1</sup></a><a href="/tags/markdown/" style="font-size: 1.05rem;">markdown<sup>1</sup></a><a href="/tags/mybatis/" style="font-size: 1.05rem;">mybatis<sup>2</sup></a><a href="/tags/mysql/" style="font-size: 1.05rem;">mysql<sup>3</sup></a><a href="/tags/nacos/" style="font-size: 1.05rem;">nacos<sup>1</sup></a><a href="/tags/npm/" style="font-size: 1.05rem;">npm<sup>1</sup></a><a href="/tags/os/" style="font-size: 1.05rem;">os<sup>1</sup></a><a href="/tags/pinia/" style="font-size: 1.05rem;">pinia<sup>1</sup></a><a href="/tags/redis/" style="font-size: 1.05rem;">redis<sup>2</sup></a><a href="/tags/shields/" style="font-size: 1.05rem;">shields<sup>1</sup></a><a href="/tags/springboot/" style="font-size: 1.05rem;">springboot<sup>2</sup></a><a href="/tags/springcloud/" style="font-size: 1.05rem;">springcloud<sup>2</sup></a><a href="/tags/windows/" style="font-size: 1.05rem;">windows<sup>1</sup></a><a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 1.05rem;">搜索<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 1.05rem;">数据库<sup>2</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE/" style="font-size: 1.05rem;">标签<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 1.05rem;">测试<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 1.05rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%82%AE%E4%BB%B6/" style="font-size: 1.05rem;">邮件<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/03/"><span class="card-archive-list-date">三月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">9</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/02/"><span class="card-archive-list-date">二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/01/"><span class="card-archive-list-date">一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/10/"><span class="card-archive-list-date">十月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/08/"><span class="card-archive-list-date">八月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2023/07/"><span class="card-archive-list-date">七月 2023</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>数据库</span></a><a class="article-meta__tags" href="/tags/mysql/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>mysql</span></a></span></div></div><h1 class="post-title" itemprop="name headline">mysql</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2023-07-28T13:21:26.000Z" title="发表于 2023-07-28 21:21:26">2023-07-28</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-04-26T05:43:37.294Z" title="更新于 2024-04-26 13:43:37">2024-04-26</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">11.1k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>49分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="mysql"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为江西"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>江西</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://img2.imgtp.com/2024/04/26/wBGeLSLD.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="https://clibin.gitee.io/2023/07/28/mysql/"><header><a class="post-meta-categories" href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url">数据库</a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" tabindex="-1" itemprop="url">数据库</a><a href="/tags/mysql/" tabindex="-1" itemprop="url">mysql</a><h1 id="CrawlerTitle" itemprop="name headline">mysql</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">caolibin</span><time itemprop="dateCreated datePublished" datetime="2023-07-28T13:21:26.000Z" title="发表于 2023-07-28 21:21:26">2023-07-28</time><time itemprop="dateCreated datePublished" datetime="2024-04-26T05:43:37.294Z" title="更新于 2024-04-26 13:43:37">2024-04-26</time></header><h1 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h1><h2 id="执行编写顺序"><a href="#执行编写顺序" class="headerlink" title="执行编写顺序"></a>执行编写顺序</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 语句编写和执行顺序</span><br><span class="hljs-keyword">select</span>    <span class="hljs-comment">-- 4</span><br>    字段列表<br><span class="hljs-keyword">from</span>    <span class="hljs-comment">-- 1</span><br>    表名列表<br><span class="hljs-keyword">where</span>    <span class="hljs-comment">-- 2</span><br>    条件列表<br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> <span class="hljs-comment">--3</span><br>    分组字段列表<br><span class="hljs-keyword">having</span>     <br>    分组后条件列表<br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-comment">--5</span><br>    排序字段列表<br>limit     <span class="hljs-comment">--6</span><br>    分页参数<br></code></pre></td></tr></table></figure>

<h1 id="一、数据定义语言DDL"><a href="#一、数据定义语言DDL" class="headerlink" title="一、数据定义语言DDL"></a>一、数据定义语言DDL</h1><h2 id="1、数据库操作"><a href="#1、数据库操作" class="headerlink" title="1、数据库操作"></a>1、数据库操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"># DDL<span class="hljs-operator">-</span>数据库操作<br><span class="hljs-keyword">show</span> databases;                          #显示所有数据库<br><span class="hljs-keyword">create</span> database [if <span class="hljs-keyword">not</span> <span class="hljs-keyword">exists</span>] 数据库名;    #创建数据库<br>use 数据库名 ;                              #使用数据库<br><span class="hljs-keyword">select</span> database();                          #显示当前在哪个数据库下<br><span class="hljs-keyword">drop</span> database [if <span class="hljs-keyword">exists</span>] 数据库名;            #删库跑路<br></code></pre></td></tr></table></figure>

<h2 id="2、表操作"><a href="#2、表操作" class="headerlink" title="2、表操作"></a>2、表操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- DDL-表操作</span><br><span class="hljs-keyword">show</span> tables;# 显示所有表<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> 表名(字段 字段类型，字段 字段类型……) # 创建表<br><span class="hljs-keyword">desc</span> 表名 #查看表中所有字段<br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> 表名 <span class="hljs-keyword">add</span>(添加字段)<span class="hljs-operator">/</span>modify(修改字段类型)<span class="hljs-operator">/</span>change(修改字段名及类型)<span class="hljs-operator">/</span><span class="hljs-keyword">drop</span>(删除字段)<span class="hljs-operator">/</span>rename <span class="hljs-keyword">to</span>(修改表名);<br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> 表名;# 删除表<br></code></pre></td></tr></table></figure>

<h1 id="二、-DML（增删改）"><a href="#二、-DML（增删改）" class="headerlink" title="二、 DML（增删改）"></a>二、 DML（增删改）</h1><h2 id="insert-update-delete"><a href="#insert-update-delete" class="headerlink" title="insert update delete"></a>insert update delete</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"># 插入一条语句<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">user</span>(id, name, age, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-number">123</span>, <span class="hljs-string">&#x27;cxk&#x27;</span>, <span class="hljs-number">25</span>, <span class="hljs-string">&#x27;男&#x27;</span>);<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">user</span>(id, name, age, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-number">456</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&#x27;男&#x27;</span>);<br><br># 插入多条语句<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> <span class="hljs-keyword">user</span><br><span class="hljs-keyword">values</span> (<span class="hljs-number">456</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&#x27;男&#x27;</span>),<br>(<span class="hljs-number">456</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&#x27;男&#x27;</span>),<br>(<span class="hljs-number">456</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&#x27;男&#x27;</span>),<br>(<span class="hljs-number">456</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>, <span class="hljs-number">21</span>, <span class="hljs-string">&#x27;男&#x27;</span>);<br><br># 查看表<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br><br># 修改 把name为ikun的name全部改为小黑子<br><span class="hljs-keyword">update</span> <span class="hljs-keyword">user</span><br><span class="hljs-keyword">set</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;小黑子&#x27;</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;ikun&#x27;</span>;<br><br># 把name为cxk的 name改为鸡哥，性别改为女<br><span class="hljs-keyword">update</span> <span class="hljs-keyword">user</span><br><span class="hljs-keyword">set</span> name  <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;鸡哥&#x27;</span>,<br>gender<span class="hljs-operator">=</span><span class="hljs-string">&#x27;女&#x27;</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;cxk&#x27;</span>;<br><br># 把所有人的年龄改为<span class="hljs-number">69</span><br><span class="hljs-keyword">update</span> <span class="hljs-keyword">user</span><br><span class="hljs-keyword">set</span> age<span class="hljs-operator">=</span><span class="hljs-number">69</span>;<br><br># 删除 name为小黑子的人<br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span> <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;小黑子&#x27;</span>;<br><br># 删除所有人<br><span class="hljs-keyword">delete</span> <span class="hljs-keyword">from</span> <span class="hljs-keyword">user</span>;<br></code></pre></td></tr></table></figure>

<h1 id="三、DQL（查）"><a href="#三、DQL（查）" class="headerlink" title="三、DQL（查）"></a>三、DQL（查）</h1><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建表并插入数据--------------------------------------------</span><br><br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">table</span> if <span class="hljs-keyword">exists</span> employee;<br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> emp<br>(<br>id          <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;编号&#x27;</span>,<br>workno      <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) comment <span class="hljs-string">&#x27;工号&#x27;</span>,<br>name        <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>gender      <span class="hljs-type">char</span>(<span class="hljs-number">1</span>) comment <span class="hljs-string">&#x27;性别&#x27;</span>,<br>age         tinyint unsigned comment <span class="hljs-string">&#x27;年龄&#x27;</span>,<br>idcard      <span class="hljs-type">char</span>(<span class="hljs-number">18</span>) comment <span class="hljs-string">&#x27;身份证号&#x27;</span>,<br>workaddress <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) comment <span class="hljs-string">&#x27;工作地址&#x27;</span>,<br>entrydate   <span class="hljs-type">date</span> comment <span class="hljs-string">&#x27;入职时间&#x27;</span><br>) comment <span class="hljs-string">&#x27;员工表&#x27;</span>;<br><br><span class="hljs-comment">-- 插入数据--------------------------------------------------------</span><br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;00001&#x27;</span>, <span class="hljs-string">&#x27;柳岩&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;123456789012345678&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;00002&#x27;</span>, <span class="hljs-string">&#x27;张无忌&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;123456789012345670&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2005-09-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;00003&#x27;</span>, <span class="hljs-string">&#x27;韦一笑&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">38</span>, <span class="hljs-string">&#x27;123456789712345670&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>, <span class="hljs-string">&#x27;2005-08-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;00004&#x27;</span>, <span class="hljs-string">&#x27;赵敏&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-string">&#x27;123456757123845670&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2009-12-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;00005&#x27;</span>, <span class="hljs-string">&#x27;小昭&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">16</span>, <span class="hljs-string">&#x27;123456769012345678&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>, <span class="hljs-string">&#x27;2007-07-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;00006&#x27;</span>, <span class="hljs-string">&#x27;杨逍&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">28</span>, <span class="hljs-string">&#x27;12345678931234567X&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2006-01-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">7</span>, <span class="hljs-string">&#x27;00007&#x27;</span>, <span class="hljs-string">&#x27;范瑶&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">40</span>, <span class="hljs-string">&#x27;123456789212345670&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2005-05-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;00008&#x27;</span>, <span class="hljs-string">&#x27;黛绮丝&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">38</span>, <span class="hljs-string">&#x27;123456157123645670&#x27;</span>, <span class="hljs-string">&#x27;天津&#x27;</span>, <span class="hljs-string">&#x27;2015-05-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">9</span>, <span class="hljs-string">&#x27;00009&#x27;</span>, <span class="hljs-string">&#x27;范凉凉&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">45</span>, <span class="hljs-string">&#x27;123156789012345678&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2010-04-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">10</span>, <span class="hljs-string">&#x27;00010&#x27;</span>, <span class="hljs-string">&#x27;陈友谅&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">53</span>, <span class="hljs-string">&#x27;123456789012345670&#x27;</span>, <span class="hljs-string">&#x27;上海&#x27;</span>, <span class="hljs-string">&#x27;2011-01-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">11</span>, <span class="hljs-string">&#x27;00011&#x27;</span>, <span class="hljs-string">&#x27;张士诚&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">55</span>, <span class="hljs-string">&#x27;123567897123465670&#x27;</span>, <span class="hljs-string">&#x27;江苏&#x27;</span>, <span class="hljs-string">&#x27;2015-05-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">12</span>, <span class="hljs-string">&#x27;00012&#x27;</span>, <span class="hljs-string">&#x27;常遇春&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">32</span>, <span class="hljs-string">&#x27;123446757152345670&#x27;</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2004-02-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">13</span>, <span class="hljs-string">&#x27;00013&#x27;</span>, <span class="hljs-string">&#x27;张三丰&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">88</span>, <span class="hljs-string">&#x27;123656789012345678&#x27;</span>, <span class="hljs-string">&#x27;江苏&#x27;</span>, <span class="hljs-string">&#x27;2020-11-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">14</span>, <span class="hljs-string">&#x27;00014&#x27;</span>, <span class="hljs-string">&#x27;灭绝&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">65</span>, <span class="hljs-string">&#x27;123456719012345670&#x27;</span>, <span class="hljs-string">&#x27;西安&#x27;</span>, <span class="hljs-string">&#x27;2019-05-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">15</span>, <span class="hljs-string">&#x27;00015&#x27;</span>, <span class="hljs-string">&#x27;胡青牛&#x27;</span>, <span class="hljs-string">&#x27;男&#x27;</span>, <span class="hljs-number">70</span>, <span class="hljs-string">&#x27;12345674971234567X&#x27;</span>, <span class="hljs-string">&#x27;西安&#x27;</span>, <span class="hljs-string">&#x27;2018-04-01&#x27;</span>);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, workno, name, gender, age, idcard, workaddress, entrydate)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">16</span>, <span class="hljs-string">&#x27;00016&#x27;</span>, <span class="hljs-string">&#x27;周芷若&#x27;</span>, <span class="hljs-string">&#x27;女&#x27;</span>, <span class="hljs-number">18</span>, <span class="hljs-keyword">null</span>, <span class="hljs-string">&#x27;北京&#x27;</span>, <span class="hljs-string">&#x27;2012-06-01&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="1、select-from"><a href="#1、select-from" class="headerlink" title="1、select from"></a>1、select from</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 基本查询-------------------------------------------------------</span><br><br><span class="hljs-comment">-- 1、查询指定字段 name,workno,age返回</span><br><span class="hljs-keyword">select</span> name, workno, age<br><span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 2、查询返回所有字段</span><br><span class="hljs-keyword">select</span> id,<br> workno,<br> name,<br> gender,<br> age,<br> idcard,<br> workaddress,<br> entrydate<br><span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 也可以查询所有字段，但实际使用中不建议，因为不明确</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 3、查询所有员工的工作地址并 起一个别名(as可以省略)</span><br><span class="hljs-keyword">select</span> workaddress <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;工作地址&#x27;</span> <span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 4、查询所有员工的工作地址并去除重复地址</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> workaddress <span class="hljs-string">&#x27;上班地址&#x27;</span> <span class="hljs-keyword">from</span> emp;<br></code></pre></td></tr></table></figure>

<h2 id="2、where"><a href="#2、where" class="headerlink" title="2、where"></a>2、where</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 条件查询 where-------------------------------------------------</span><br><br><span class="hljs-comment">-- 1、查询年龄为88的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age<span class="hljs-operator">=</span><span class="hljs-number">88</span>;<br><br><span class="hljs-comment">-- 2、查询年龄小于20的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age<span class="hljs-operator">&lt;</span><span class="hljs-number">20</span>;<br><br><span class="hljs-comment">-- 3、查询没有身份证号码的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> idcard <span class="hljs-keyword">is</span> <span class="hljs-keyword">null</span>;<br><br><span class="hljs-comment">-- 4、查询有身份证号码的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> idcard <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span>;<br><br><span class="hljs-comment">-- 5、查询年龄不等于88的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">!=</span> <span class="hljs-number">88</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;&gt;</span> <span class="hljs-number">88</span>;<br><br><span class="hljs-comment">-- 6、查询年龄在15到20（两端都包含）之间的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">&gt;=</span> <span class="hljs-number">15</span> <span class="hljs-operator">&amp;&amp;</span> age <span class="hljs-operator">&lt;=</span> <span class="hljs-number">20</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">&gt;=</span> <span class="hljs-number">15</span> <span class="hljs-keyword">and</span> age <span class="hljs-operator">&lt;=</span> <span class="hljs-number">20</span>;<br><span class="hljs-comment">-- between and 小的在前面 大的在后面 否则什么都查不到</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-keyword">between</span> <span class="hljs-number">15</span> <span class="hljs-keyword">and</span> <span class="hljs-number">20</span>;<br><br><span class="hljs-comment">-- 7、查询性别为女且年龄小于25的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> gender <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;女&#x27;</span> <span class="hljs-keyword">and</span> age <span class="hljs-operator">&lt;</span> <span class="hljs-number">25</span>;<br><br><span class="hljs-comment">-- 8、查询年龄或等于18或20或40的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">=</span> <span class="hljs-number">18</span> <span class="hljs-operator">||</span>age <span class="hljs-operator">=</span> <span class="hljs-number">20</span> <span class="hljs-operator">||</span> age <span class="hljs-operator">=</span> <span class="hljs-number">40</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-operator">=</span> <span class="hljs-number">18</span> <span class="hljs-keyword">or</span> age <span class="hljs-operator">=</span> <span class="hljs-number">20</span> <span class="hljs-keyword">or</span> age <span class="hljs-operator">=</span> <span class="hljs-number">40</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> age <span class="hljs-keyword">in</span> (<span class="hljs-number">18</span>,<span class="hljs-number">20</span>,<span class="hljs-number">40</span>);<br><br><span class="hljs-comment">-- 9、查询名字为两个字的员工的信息 模糊匹配：like _对应单个字符 %对应多个字符</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> name <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;__&#x27;</span>;<br><br><span class="hljs-comment">-- 10、查询身份证号最后一位是X的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> idcard <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%X&#x27;</span>;<br># <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> idcard <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;_________________X&#x27;</span>; 这样不太好<br><br><span class="hljs-comment">-- 11、查询身份证号倒数第九位是0的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> idcard <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;%0________&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h2 id="3、count、max、group"><a href="#3、count、max、group" class="headerlink" title="3、count、max、group"></a>3、count、max、group</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 聚合函数 max min avg:最大最小平均值 sum:整列数据加起来 count:统计整列数据的个数 作用于列 所有聚合函数不参与null的计算--</span><br><br><br><span class="hljs-comment">-- 1、统计企业员工数量</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> emp; <span class="hljs-comment">-- 16</span><br><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(idcard) <span class="hljs-keyword">from</span> emp; <span class="hljs-comment">-- 15因为有一个员工的身份证号码为null</span><br><br><span class="hljs-comment">-- 2、统计所有员工的平均年龄</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(age) <span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 3、查询最大的年龄</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">max</span>(age) <span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 4、查询最小的年龄</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">min</span>(age) <span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-comment">-- 5、统计西安地区员工年龄之和</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">sum</span>(age) <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> workaddress <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;西安&#x27;</span>;<br><br><span class="hljs-comment">-- 分组查询 group by   [having 条件]</span><br><br><span class="hljs-comment">-- 1、根据性别分组，分别统计男女人数</span><br><span class="hljs-comment">-- 根据什么字段分组就查询什么字段，查询其他字段无意义</span><br><span class="hljs-comment">-- count(*)此处表示每组的数量</span><br><span class="hljs-keyword">select</span> gender,<span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> gender;<br><br><span class="hljs-comment">-- 2、根据性别分组，分别统计男女平均年龄</span><br><span class="hljs-keyword">select</span> gender,<span class="hljs-built_in">avg</span>(age) <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> gender;<br><br><span class="hljs-comment">-- 3、查询年龄小于45的员工，并根据工作地址分组，获取员工数量大于等于3的工作地址</span><br><span class="hljs-comment">-- having后面也接条件，与where不同的是，having对分组后的数据进行操作,having可以对聚合函数进行判断，where不行</span><br><span class="hljs-comment">-- 执行顺序：where&gt;聚合函数&gt;having 分组后查询字段一般为聚合函数或分组字段，因为查询其他字段无意义</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">as</span> address_count,workaddress <span class="hljs-keyword">from</span> emp <br><span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;</span> <span class="hljs-number">45</span> <br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> workaddress <span class="hljs-keyword">having</span> address_count <span class="hljs-operator">&gt;=</span> <span class="hljs-number">3</span>;<br></code></pre></td></tr></table></figure>

<h2 id="4、order-by"><a href="#4、order-by" class="headerlink" title="4、order by"></a>4、order by</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 排序查询 order by----------------------------------------------</span><br><br><span class="hljs-comment">-- 1、根据年龄对员工进行排序</span><br><span class="hljs-comment">-- 升序排序</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age; <span class="hljs-comment">-- 默认升序排序</span><br># <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">asc</span>;<br><br><span class="hljs-comment">-- 降序排序</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-comment">-- 2、根据入职时间，对员工进行降序排序</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> entrydate <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-comment">-- 3、根据年龄升序排序，若年龄相同，根据入职时间降序排序</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age, entrydate <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> name <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-comment">-- 分页查询(把所有数据一页一页展示出来) limit 起始索引，查询的个数---------&gt;起始索引=（页码数-1）*每页展示数--------------------------------------------------------------------</span><br><span class="hljs-comment">-- 分页查询limit是MySQL的方言，不同的数据库语言有不同的实现</span><br><br><span class="hljs-comment">-- 1、查询第1页员工数据，查询个数为10</span><br># <span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp limit <span class="hljs-number">0</span>,<span class="hljs-number">10</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br>limit <span class="hljs-number">10</span>;<br><span class="hljs-comment">-- 第一页的其实索引可以省略</span><br><br><span class="hljs-comment">-- 2、查询第2页员工数据，查询个数为10,不足10条则全部显示</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br>limit <span class="hljs-number">10</span>,<span class="hljs-number">10</span>;<br></code></pre></td></tr></table></figure>

<h2 id="5、案例"><a href="#5、案例" class="headerlink" title="5、案例"></a>5、案例</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- DQL案例--------------------------------------------------------</span><br><br><span class="hljs-comment">-- 1.查询年龄为20,21,22,23岁的员工信息。</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-operator">=</span> <span class="hljs-number">20</span><br><span class="hljs-keyword">or</span> age <span class="hljs-operator">=</span> <span class="hljs-number">21</span><br><span class="hljs-keyword">or</span> age <span class="hljs-operator">=</span> <span class="hljs-number">22</span><br><span class="hljs-keyword">or</span> age <span class="hljs-operator">=</span> <span class="hljs-number">23</span>;<br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-keyword">in</span> (<span class="hljs-number">20</span>, <span class="hljs-number">21</span>, <span class="hljs-number">22</span>, <span class="hljs-number">23</span>);<br><br><span class="hljs-comment">-- 2.查询性别为男，并且年龄在20-40岁（含）以内的姓名为三个字的员工。</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> gender <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;男&#x27;</span><br><span class="hljs-keyword">and</span> age <span class="hljs-keyword">between</span> <span class="hljs-number">20</span> <span class="hljs-keyword">and</span> <span class="hljs-number">40</span><br><span class="hljs-keyword">and</span> name <span class="hljs-keyword">like</span> <span class="hljs-string">&#x27;___&#x27;</span>;<br><br><span class="hljs-comment">-- 3.统计员工表中，年龄小于60岁的，男性员工和女性员工的人数。</span><br><span class="hljs-keyword">select</span> gender, <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;</span> <span class="hljs-number">60</span><br><span class="hljs-keyword">group</span> <span class="hljs-keyword">by</span> gender;<br><br><span class="hljs-comment">-- 4.查询所有年龄小于等于35岁员工的姓名和年龄，并对查询结果按年龄升序排序，如果年龄相同按入职时间降序排序。</span><br><span class="hljs-keyword">select</span> name, age, entrydate<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-operator">&lt;=</span> <span class="hljs-number">35</span><br><span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> age, entrydate <span class="hljs-keyword">desc</span>;<br><br><span class="hljs-comment">-- 5.查询性别为男，且年龄在20-40岁（含）以内的员工信息，对查询的结果按年龄升序排序，年龄相同按入职时间升序排序,取前5个员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> gender <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;男&#x27;</span><br><span class="hljs-keyword">and</span> age <span class="hljs-keyword">between</span> <span class="hljs-number">20</span> <span class="hljs-keyword">and</span> <span class="hljs-number">40</span>;<br></code></pre></td></tr></table></figure>

<h1 id="四、-DCL"><a href="#四、-DCL" class="headerlink" title="四、 DCL"></a>四、 DCL</h1><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- DCL---------------------------------------------------------</span><br><br><span class="hljs-comment">-- 创建用户</span><br><span class="hljs-comment">-- 创建用户‘tanking’，只能在当前主机localhost访问，密码是123456</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;tanking&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123456&#x27;</span>;<br><br><span class="hljs-comment">-- 创建用户‘cxk’，能在任意主机访问数据库，密码 ctrljntm,%为通配符</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;cxk&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> identified <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;ctrljntm&#x27;</span>;<br><br><span class="hljs-comment">-- 修改cxk密码为‘123’</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;cxk&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span> identified <span class="hljs-keyword">with</span> mysql_native_password <span class="hljs-keyword">by</span> <span class="hljs-string">&#x27;123&#x27;</span>;<br><br><span class="hljs-comment">-- 删除用户‘tanking’</span><br><span class="hljs-keyword">drop</span> <span class="hljs-keyword">user</span> <span class="hljs-string">&#x27;tanking&#x27;</span>@<span class="hljs-string">&#x27;localhost&#x27;</span>;<br><br><span class="hljs-comment">-- 查询权限---------------------------------------------------</span><br><span class="hljs-keyword">show</span> grants <span class="hljs-keyword">for</span> cxk;<br><br><span class="hljs-comment">-- 给 用户cxk 授予 对clb数据库中所有表操作 的 所有权限</span><br><span class="hljs-keyword">grant</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> clb.<span class="hljs-operator">*</span> <span class="hljs-keyword">to</span> <span class="hljs-string">&#x27;cxk&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br><br><span class="hljs-comment">-- 撤销 cxk对clb数据库中所有表操作的所有权限</span><br><span class="hljs-keyword">revoke</span> <span class="hljs-keyword">all</span> <span class="hljs-keyword">on</span> clb.<span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> <span class="hljs-string">&#x27;cxk&#x27;</span>@<span class="hljs-string">&#x27;%&#x27;</span>;<br></code></pre></td></tr></table></figure>

<h1 id="五、-函数"><a href="#五、-函数" class="headerlink" title="五、 函数"></a>五、 函数</h1><h2 id="1、字符串函数"><a href="#1、字符串函数" class="headerlink" title="1、字符串函数"></a>1、字符串函数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 字符串函数----------------------------------------------</span><br><span class="hljs-comment">-- concat 拼接字符串</span><br><span class="hljs-keyword">select</span> concat(<span class="hljs-string">&#x27;hello&#x27;</span>,<span class="hljs-string">&#x27;mysql&#x27;</span>);<br><br><span class="hljs-comment">-- lower 字符串全部小写</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">lower</span>(<span class="hljs-string">&#x27;HelloWorld&#x27;</span>);<br><br><span class="hljs-comment">-- upper 字符串全部大写</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">upper</span>(<span class="hljs-string">&#x27;helloworld&#x27;</span>);<br><br><span class="hljs-comment">-- lpad 左填充 中间的参数表示 字符串的长度，最后参数表示 以什么字符填充</span><br><span class="hljs-keyword">select</span> lpad(<span class="hljs-string">&#x27;cxk&#x27;</span>, <span class="hljs-number">6</span>, <span class="hljs-string">&#x27;-&#x27;</span>);<br><br><span class="hljs-comment">-- rpad 右填充 参数同上</span><br><span class="hljs-keyword">select</span> rpad(<span class="hljs-string">&#x27;cxk&#x27;</span>, <span class="hljs-number">6</span>, <span class="hljs-string">&#x27;&lt;&#x27;</span>);<br><br><span class="hljs-comment">-- trim 去除字符串头尾的空格</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">trim</span>(<span class="hljs-string">&#x27;  cxk ctrl &#x27;</span>);<br><br><span class="hljs-comment">-- substring(str,1,5) 截取字符串 此处表示截取 从索引1开始截取 字符串str 长度为5 的 子串（注意这个索引是从1开始的）</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">substring</span>(<span class="hljs-string">&#x27;hello_mysql&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">5</span>);<br></code></pre></td></tr></table></figure>

<h2 id="2、数值函数"><a href="#2、数值函数" class="headerlink" title="2、数值函数"></a>2、数值函数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 数值函数----------------------------------------------</span><br><br><span class="hljs-comment">-- ceil 向上取整，只要小数位不是0，就加1</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">ceil</span>(<span class="hljs-number">1.1</span>);<br><span class="hljs-keyword">select</span> <span class="hljs-built_in">ceil</span>(<span class="hljs-number">1.0</span>);<br><br><span class="hljs-comment">-- floor 向下取整</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">floor</span>(<span class="hljs-number">1.9</span>);<br><br><span class="hljs-comment">-- mod 模 （取余数）</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">mod</span>(<span class="hljs-number">6</span>, <span class="hljs-number">4</span>);<br><br><span class="hljs-comment">-- rand 生成 0~1之间 的随机数</span><br><span class="hljs-keyword">select</span> rand();<br><br><span class="hljs-comment">-- round 四舍五入 保留位数</span><br><span class="hljs-keyword">select</span> round(<span class="hljs-number">2.305</span>, <span class="hljs-number">2</span>);<br><span class="hljs-comment">-- 对2.305四舍五入，保留2位小数</span><br><br><span class="hljs-comment">-- 案例：生成一个6位数的随机验证码</span><br><span class="hljs-keyword">select</span> lpad(round(rand(), <span class="hljs-number">6</span>) <span class="hljs-operator">*</span> <span class="hljs-number">1000000</span>, <span class="hljs-number">6</span>, <span class="hljs-string">&#x27;0&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h2 id="3、日期函数"><a href="#3、日期函数" class="headerlink" title="3、日期函数"></a>3、日期函数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 日期函数</span><br><br><span class="hljs-comment">-- curdate 返回当前日期</span><br><span class="hljs-keyword">select</span> curdate();<br><br><span class="hljs-comment">-- curtime 返回当前时间</span><br><span class="hljs-keyword">select</span> curtime();<br><br><span class="hljs-comment">-- now 返回当前时间和日期</span><br><span class="hljs-keyword">select</span> now();<br><br><span class="hljs-comment">-- year month day 分别获取 年月日</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">year</span>(now());<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">month</span>(now());<br><span class="hljs-keyword">select</span> <span class="hljs-keyword">day</span>(now());<br><br><span class="hljs-comment">-- date_add 指定日期加上一定时间后的日期及时间</span><br><span class="hljs-keyword">select</span> date_add(now(), <span class="hljs-type">interval</span> <span class="hljs-number">66</span> <span class="hljs-keyword">day</span>);    <span class="hljs-comment">-- 从现在往后推66天</span><br><br><span class="hljs-keyword">select</span> date_add(now(), <span class="hljs-type">interval</span> <span class="hljs-number">-10</span> <span class="hljs-keyword">year</span>);  <span class="hljs-comment">-- 从现在往前推10年</span><br><br><span class="hljs-comment">-- datediff 返回两个日期之间相差的天数(前面的日期-后面的日期)</span><br><span class="hljs-keyword">select</span> datediff(now(), <span class="hljs-string">&#x27;2002-10-26&#x27;</span>);   <span class="hljs-comment">-- 从我生日到现在多少天了</span><br><br><br><span class="hljs-comment">-- 案例：查询所有员工入职天数，并按照降序排序</span><br><span class="hljs-keyword">select</span> name,datediff(curdate(),entrydate) <span class="hljs-keyword">as</span> 入职天数 <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> 入职天数 <span class="hljs-keyword">desc</span>;<br></code></pre></td></tr></table></figure>

<h2 id="4、流程控制函数"><a href="#4、流程控制函数" class="headerlink" title="4、流程控制函数"></a>4、流程控制函数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- if(bool,val1,val2) true返回val1 false返回val2</span><br><span class="hljs-keyword">select</span> if(<span class="hljs-literal">true</span>, <span class="hljs-string">&#x27;cxk&#x27;</span>, <span class="hljs-string">&#x27;ikun&#x27;</span>);<br><span class="hljs-comment">-- 类似于三目运算符</span><br><br><span class="hljs-comment">-- ifnull(v1,v2) 如果v1不为null，返回v1,为null返回v2</span><br><span class="hljs-keyword">select</span> ifnull(<span class="hljs-string">&#x27;ok&#x27;</span>, <span class="hljs-string">&#x27;v2&#x27;</span>);<br><br><span class="hljs-keyword">select</span> ifnull(<span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">&#x27;v2&#x27;</span>); <span class="hljs-comment">-- 注意空字符串不是null</span><br><br><span class="hljs-keyword">select</span> ifnull(<span class="hljs-keyword">null</span>, <span class="hljs-string">&#x27;v2&#x27;</span>);<br><br><span class="hljs-comment">-- case when then else end</span><br><span class="hljs-comment">-- 查询员工姓名和工作地址，条件 北京/上海 ---&gt; 一线城市 其他 ---&gt; 二线城市</span><br><span class="hljs-keyword">select</span> name,<br> (<span class="hljs-keyword">case</span> workaddress<br>      <span class="hljs-keyword">when</span> <span class="hljs-string">&#x27;北京&#x27;</span> <span class="hljs-keyword">then</span> concat(emp.workaddress, <span class="hljs-string">&#x27; 一线城市&#x27;</span>)<br>      <span class="hljs-keyword">when</span> <span class="hljs-string">&#x27;上海&#x27;</span> <span class="hljs-keyword">then</span> concat(emp.workaddress, <span class="hljs-string">&#x27; 一线城市&#x27;</span>)<br>      <span class="hljs-keyword">else</span> concat(emp.workaddress, <span class="hljs-string">&#x27; 二线城市&#x27;</span>) <span class="hljs-keyword">end</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;工作地址&#x27;</span><br><span class="hljs-keyword">from</span> emp;<br></code></pre></td></tr></table></figure>

<h3 id="案例"><a href="#案例" class="headerlink" title="案例"></a>案例</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 案例：统计班级各个学生的成绩，展示规则如下</span><br><span class="hljs-comment">-- &gt;= 85 优秀</span><br><span class="hljs-comment">-- &gt;= 60 及格</span><br><span class="hljs-comment">-- 否则 不及格</span><br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> score<br>(<br>    id      <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;编号&#x27;</span>,<br>    name    <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>    math    tinyint unsigned comment <span class="hljs-string">&#x27;数学&#x27;</span>,<br>    English tinyint unsigned comment <span class="hljs-string">&#x27;英语&#x27;</span>,<br>    Chinese tinyint unsigned comment <span class="hljs-string">&#x27;语文&#x27;</span><br>) comment <span class="hljs-string">&#x27;成绩表&#x27;</span>;<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> score<br><span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;Tom&#x27;</span>, <span class="hljs-number">67</span>, <span class="hljs-number">88</span>, <span class="hljs-number">95</span>),<br> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;Rose&#x27;</span>, <span class="hljs-number">23</span>, <span class="hljs-number">66</span>, <span class="hljs-number">90</span>),<br> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;Jack&#x27;</span>, <span class="hljs-number">56</span>, <span class="hljs-number">98</span>, <span class="hljs-number">76</span>);<br><br><span class="hljs-keyword">select</span> name,<br> (<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> math <span class="hljs-operator">&gt;=</span> <span class="hljs-number">85</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;优秀&#x27;</span> <span class="hljs-keyword">when</span> math <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;及格&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;不及格&#x27;</span> <span class="hljs-keyword">end</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;数学&#x27;</span>,<br> (<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> English <span class="hljs-operator">&gt;=</span> <span class="hljs-number">85</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;优秀&#x27;</span> <span class="hljs-keyword">when</span> English <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;及格&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;不及格&#x27;</span> <span class="hljs-keyword">end</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;英语&#x27;</span>,<br> (<span class="hljs-keyword">case</span> <span class="hljs-keyword">when</span> Chinese <span class="hljs-operator">&gt;=</span> <span class="hljs-number">85</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;优秀&#x27;</span> <span class="hljs-keyword">when</span> Chinese <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span> <span class="hljs-keyword">then</span> <span class="hljs-string">&#x27;及格&#x27;</span> <span class="hljs-keyword">else</span> <span class="hljs-string">&#x27;不及格&#x27;</span> <span class="hljs-keyword">end</span>) <span class="hljs-keyword">as</span> <span class="hljs-string">&#x27;语文&#x27;</span><br><span class="hljs-keyword">from</span> score;<br></code></pre></td></tr></table></figure>

<h1 id="六、约束"><a href="#六、约束" class="headerlink" title="六、约束"></a>六、约束</h1><h2 id="1、基础约束"><a href="#1、基础约束" class="headerlink" title="1、基础约束"></a>1、基础约束</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> user2<br>(<br>id     <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment comment <span class="hljs-string">&#x27;主键&#x27;</span>,       <br>    <span class="hljs-comment">-- primary key:主键，auto_increment:id随插入的数据自动增加，无需插入</span><br><br> name   <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">unique</span> comment <span class="hljs-string">&#x27;姓名&#x27;</span>,          <br>    <span class="hljs-comment">-- not null:不能为空，unique:唯一的，其他行不能出现重复</span><br><br> age    <span class="hljs-type">int</span> <span class="hljs-keyword">check</span> ( age <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> age <span class="hljs-operator">&lt;=</span> <span class="hljs-number">120</span> ) comment <span class="hljs-string">&#x27;年龄&#x27;</span>, <br>    <span class="hljs-comment">-- check(条件):必须满足check中的条件</span><br><br> status <span class="hljs-type">char</span>(<span class="hljs-number">1</span>) <span class="hljs-keyword">default</span> <span class="hljs-string">&#x27;1&#x27;</span> comment <span class="hljs-string">&#x27;状态&#x27;</span>,                  <br>    <span class="hljs-comment">-- default:没有指定时的默认值</span><br><br> gender <span class="hljs-type">char</span>(<span class="hljs-number">1</span>) comment <span class="hljs-string">&#x27;性别&#x27;</span><br>) comment <span class="hljs-string">&#x27;用户表&#x27;</span>;<br></code></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 插入数据</span><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2(name, age, status, gender) <span class="hljs-comment">-- id为主键，无需插入，插入也没用，会自动更正</span><br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;Tom1&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>),<br>(<span class="hljs-string">&#x27;Tom2&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>);<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2(name, age, status, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-keyword">null</span>, <span class="hljs-number">10</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>); <span class="hljs-comment">-- 插入的name不能为null，报错</span><br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2 (name, age, status, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;Tom1&#x27;</span>, <span class="hljs-number">11</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>); <span class="hljs-comment">-- 插入的name不能重复，报错,虽然没有成功，但是已经申请到主键，所以会空出一个主键</span><br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2(name, age, status, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;Tom3&#x27;</span>, <span class="hljs-number">80</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>);<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2(name, age, status, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;Tom3&#x27;</span>, <span class="hljs-number">-1</span>, <span class="hljs-number">0</span>, <span class="hljs-string">&#x27;男&#x27;</span>); <span class="hljs-comment">-- 插入的年龄超出0~120的范围，报错</span><br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> user2(name, age, gender)<br><span class="hljs-keyword">values</span> (<span class="hljs-string">&#x27;Tom4&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-string">&#x27;男&#x27;</span>); <span class="hljs-comment">-- 不插入status，插入数据后status值默认为1</span><br></code></pre></td></tr></table></figure>

<h2 id="2、外键约束"><a href="#2、外键约束" class="headerlink" title="2、外键约束"></a>2、外键约束</h2><h3 id="1、增、删外键"><a href="#1、增、删外键" class="headerlink" title="1、增、删外键"></a>1、增、删外键</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 外键约束</span><br><br><span class="hljs-comment">-- 准备数据:准备两张表并插入数据</span><br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dept<br>(<br>id   <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment comment <span class="hljs-string">&#x27;ID&#x27;</span>,<br>name <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;部门名称&#x27;</span><br>) comment <span class="hljs-string">&#x27;部门表&#x27;</span>;<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> dept(id, name)<br><span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;研发部&#x27;</span>),<br> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;市场部&#x27;</span>),<br> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;财务部&#x27;</span>),<br> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;销售部&#x27;</span>),<br> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;总经办&#x27;</span>);<br><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> emp<br>(<br>id        <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key auto_increment comment <span class="hljs-string">&#x27;主键&#x27;</span>,<br>name      <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">unique</span> comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>age       <span class="hljs-type">int</span> <span class="hljs-keyword">check</span> ( age <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> <span class="hljs-keyword">and</span> age <span class="hljs-operator">&lt;=</span> <span class="hljs-number">120</span> ) comment <span class="hljs-string">&#x27;年龄&#x27;</span>,<br>job       <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) comment <span class="hljs-string">&#x27;工作&#x27;</span>,<br>salary    <span class="hljs-type">int</span> <span class="hljs-keyword">check</span> ( salary <span class="hljs-operator">&gt;</span> <span class="hljs-number">0</span> ) comment <span class="hljs-string">&#x27;工资&#x27;</span>,<br>entrydate <span class="hljs-type">date</span> comment <span class="hljs-string">&#x27;入职时间&#x27;</span>,<br>managerid <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;直属领导ID&#x27;</span>,<br>dept_id   <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;部门ID&#x27;</span><br>) comment <span class="hljs-string">&#x27;员工表&#x27;</span>;<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> emp(id, name, age, job, salary, entrydate, managerid, dept_id)<br><span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;金庸&#x27;</span>, <span class="hljs-number">66</span>, <span class="hljs-string">&#x27;总裁&#x27;</span>, <span class="hljs-number">20000</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>, <span class="hljs-keyword">null</span>, <span class="hljs-number">5</span>),<br> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;张无忌&#x27;</span>, <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;项目经理&#x27;</span>, <span class="hljs-number">12500</span>, <span class="hljs-string">&#x27;2005-12-05&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;杨逍 &#x27;</span>, <span class="hljs-number">33</span>, <span class="hljs-string">&#x27;开发&#x27;</span>, <span class="hljs-number">8400</span>, <span class="hljs-string">&#x27;2000-11-03&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;韦一笑&#x27;</span>, <span class="hljs-number">48</span>, <span class="hljs-string">&#x27;开发 &#x27;</span>, <span class="hljs-number">11000</span>, <span class="hljs-string">&#x27;2002-02-05&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;常遇春&#x27;</span>, <span class="hljs-number">43</span>, <span class="hljs-string">&#x27;开发&#x27;</span>, <span class="hljs-number">10500</span>, <span class="hljs-string">&#x27;2004-09-07&#x27;</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;小昭&#x27;</span>, <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;程序员鼓励师&#x27;</span>, <span class="hljs-number">6600</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>);<br><br><span class="hljs-comment">-- 添加外键</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp <span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> fk_emp_dept_id <span class="hljs-keyword">foreign</span> key (dept_id) <span class="hljs-keyword">references</span><br>dept(id);<br><br><span class="hljs-comment">-- 给emp表的dept_id添加外键约束，关联dept表的主键id，dept变为emp的主表</span><br><span class="hljs-comment">-- fk_emp_dept_id:外键名</span><br><br><span class="hljs-comment">-- 删除外键</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp <span class="hljs-keyword">drop</span> <span class="hljs-keyword">foreign</span> key fk_emp_dept_id;<br></code></pre></td></tr></table></figure>

<h3 id="2、删除、更新行为"><a href="#2、删除、更新行为" class="headerlink" title="2、删除、更新行为"></a>2、删除、更新行为</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 删除、更新行为</span><br><span class="hljs-comment">-- 添加外键 + on cascade</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br><span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> fk_emp_dept_id <span class="hljs-keyword">foreign</span> key (dept_id) <span class="hljs-keyword">references</span> dept (id) <span class="hljs-keyword">on</span> <span class="hljs-keyword">update</span> cascade <span class="hljs-keyword">on</span> <span class="hljs-keyword">delete</span> cascade;<br><br><span class="hljs-comment">-- cascade 在父表中删除/更新外键记录（外键数据）时，检查是否有外键，若有，则子表中的数据也相应的删除/更新</span><br><span class="hljs-comment">-- 通俗：父表删除或更新外键，子表只要有与父表相关的外键，那么子表也跟着更新或删除</span><br><span class="hljs-comment">-- 删除研发部的外键id后，emp表中所有dept_id对应研发部的员工都会被删除</span><br><br><span class="hljs-comment">-- 添加外键 + on set null</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br><span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> fk_emp_dept_id <span class="hljs-keyword">foreign</span> key (dept_id) <span class="hljs-keyword">references</span> dept (id) <span class="hljs-keyword">on</span> <span class="hljs-keyword">update</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">null</span> <span class="hljs-keyword">on</span> <span class="hljs-keyword">delete</span> <span class="hljs-keyword">set</span> <span class="hljs-keyword">null</span>;<br><br><span class="hljs-comment">-- 通俗：父表删除或更新外键，子表只要有与父表相关的外键，那么子表直接设置为null</span><br></code></pre></td></tr></table></figure>

<h1 id="七、多表查询"><a href="#七、多表查询" class="headerlink" title="七、多表查询"></a>七、多表查询</h1><h2 id="1、概述"><a href="#1、概述" class="headerlink" title="1、概述"></a>1、概述</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 创建dept表，并插入数据</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> dept<br>(<br>id   <span class="hljs-type">int</span> auto_increment comment <span class="hljs-string">&#x27;ID&#x27;</span> <span class="hljs-keyword">primary</span> key,<br>name <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;部门名称&#x27;</span><br>) comment <span class="hljs-string">&#x27;部门表&#x27;</span>;<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> dept (id, name)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;研发部&#x27;</span>),<br> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;市场部&#x27;</span>),<br> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;财务部&#x27;</span>),<br> (<span class="hljs-number">4</span>,<br>  <span class="hljs-string">&#x27;销售部&#x27;</span>),<br> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;总经办&#x27;</span>),<br> (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;人事部&#x27;</span>);<br><span class="hljs-comment">-- 创建emp表，并插入数据</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> emp<br>(<br>    id        <span class="hljs-type">int</span> auto_increment comment <span class="hljs-string">&#x27;ID&#x27;</span> <span class="hljs-keyword">primary</span> key,<br>    name      <span class="hljs-type">varchar</span>(<span class="hljs-number">50</span>) <span class="hljs-keyword">not</span> <span class="hljs-keyword">null</span> comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>    age       <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;年龄&#x27;</span>,<br>    job       <span class="hljs-type">varchar</span>(<span class="hljs-number">20</span>) comment <span class="hljs-string">&#x27;职位&#x27;</span>,<br>    salary    <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;薪资&#x27;</span>,<br>    entrydate <span class="hljs-type">date</span> comment <span class="hljs-string">&#x27;入职时间&#x27;</span>,<br>    managerid <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;直属领导ID&#x27;</span>,<br>    dept_id   <span class="hljs-type">int</span> comment <span class="hljs-string">&#x27;部门ID&#x27;</span><br>) comment <span class="hljs-string">&#x27;员工表&#x27;</span>;<br><span class="hljs-comment">-- 添加外键</span><br><span class="hljs-keyword">alter</span> <span class="hljs-keyword">table</span> emp<br><span class="hljs-keyword">add</span> <span class="hljs-keyword">constraint</span> fk_emp_dept_id <span class="hljs-keyword">foreign</span> key (dept_id) <span class="hljs-keyword">references</span><br>  dept (id);<br><span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span> emp (id, name, age, job, salary, entrydate, managerid, dept_id)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-number">1</span>, <span class="hljs-string">&#x27;金庸&#x27;</span>, <span class="hljs-number">66</span>, <span class="hljs-string">&#x27;总裁&#x27;</span>, <span class="hljs-number">20000</span>, <span class="hljs-string">&#x27;2000-01-01&#x27;</span>, <span class="hljs-keyword">null</span>, <span class="hljs-number">5</span>),<br> (<span class="hljs-number">2</span>, <span class="hljs-string">&#x27;张无忌&#x27;</span>, <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;项目经理&#x27;</span>, <span class="hljs-number">12500</span>, <span class="hljs-string">&#x27;2005-12-05&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">3</span>, <span class="hljs-string">&#x27;杨逍&#x27;</span>, <span class="hljs-number">33</span>, <span class="hljs-string">&#x27;开发&#x27;</span>, <span class="hljs-number">8400</span>, <span class="hljs-string">&#x27;2000-11-03&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;韦一笑&#x27;</span>, <span class="hljs-number">48</span>, <span class="hljs-string">&#x27;开发&#x27;</span>, <span class="hljs-number">11000</span>, <span class="hljs-string">&#x27;2002-02-05&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">5</span>, <span class="hljs-string">&#x27;常遇春&#x27;</span>, <span class="hljs-number">43</span>, <span class="hljs-string">&#x27;开发&#x27;</span>, <span class="hljs-number">10500</span>, <span class="hljs-string">&#x27;2004-09-07&#x27;</span>, <span class="hljs-number">3</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">6</span>, <span class="hljs-string">&#x27;小昭&#x27;</span>, <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;程序员鼓励师&#x27;</span>, <span class="hljs-number">6600</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">2</span>, <span class="hljs-number">1</span>),<br> (<span class="hljs-number">7</span>, <span class="hljs-string">&#x27;灭绝&#x27;</span>, <span class="hljs-number">60</span>, <span class="hljs-string">&#x27;财务总监&#x27;</span>, <span class="hljs-number">8500</span>, <span class="hljs-string">&#x27;2002-09-12&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">3</span>),<br> (<span class="hljs-number">8</span>, <span class="hljs-string">&#x27;周芷若&#x27;</span>, <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;会计&#x27;</span>, <span class="hljs-number">48000</span>, <span class="hljs-string">&#x27;2006-06-02&#x27;</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>),<br> (<span class="hljs-number">9</span>, <span class="hljs-string">&#x27;丁敏君&#x27;</span>, <span class="hljs-number">23</span>, <span class="hljs-string">&#x27;出纳&#x27;</span>, <span class="hljs-number">5250</span>, <span class="hljs-string">&#x27;2009-05-13&#x27;</span>, <span class="hljs-number">7</span>, <span class="hljs-number">3</span>),<br> (<span class="hljs-number">10</span>, <span class="hljs-string">&#x27;赵敏&#x27;</span>, <span class="hljs-number">20</span>, <span class="hljs-string">&#x27;市场部总监&#x27;</span>, <span class="hljs-number">12500</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">2</span>),<br> (<span class="hljs-number">11</span>, <span class="hljs-string">&#x27;鹿杖客&#x27;</span>, <span class="hljs-number">56</span>, <span class="hljs-string">&#x27;职员&#x27;</span>, <span class="hljs-number">3750</span>, <span class="hljs-string">&#x27;2006-10-03&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>),<br> (<span class="hljs-number">12</span>, <span class="hljs-string">&#x27;鹤笔翁&#x27;</span>, <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;职员&#x27;</span>, <span class="hljs-number">3750</span>, <span class="hljs-string">&#x27;2007-05-09&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>),<br> (<span class="hljs-number">13</span>, <span class="hljs-string">&#x27;方东白&#x27;</span>, <span class="hljs-number">19</span>, <span class="hljs-string">&#x27;职员&#x27;</span>, <span class="hljs-number">5500</span>, <span class="hljs-string">&#x27;2009-02-12&#x27;</span>, <span class="hljs-number">10</span>, <span class="hljs-number">2</span>),<br> (<span class="hljs-number">14</span>, <span class="hljs-string">&#x27;张三丰&#x27;</span>, <span class="hljs-number">88</span>, <span class="hljs-string">&#x27;销售总监&#x27;</span>, <span class="hljs-number">14000</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-number">4</span>),<br> (<span class="hljs-number">15</span>, <span class="hljs-string">&#x27;俞莲舟&#x27;</span>, <span class="hljs-number">38</span>, <span class="hljs-string">&#x27;销售&#x27;</span>, <span class="hljs-number">4600</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>),<br> (<span class="hljs-number">16</span>, <span class="hljs-string">&#x27;宋远桥&#x27;</span>, <span class="hljs-number">40</span>, <span class="hljs-string">&#x27;销售&#x27;</span>, <span class="hljs-number">4600</span>, <span class="hljs-string">&#x27;2004-10-12&#x27;</span>, <span class="hljs-number">14</span>, <span class="hljs-number">4</span>),<br> (<span class="hljs-number">17</span>, <span class="hljs-string">&#x27;陈友谅&#x27;</span>, <span class="hljs-number">42</span>, <span class="hljs-keyword">null</span>, <span class="hljs-number">2000</span>, <span class="hljs-string">&#x27;2011-10-12&#x27;</span>, <span class="hljs-number">1</span>, <span class="hljs-keyword">null</span>);<br><br><span class="hljs-comment">-- 多表查询 -- 笛卡尔积（A集合与B集合所有的组合的情况）</span><br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp,<br>dept<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> dept.id;    <span class="hljs-comment">-- 通过条件消除多余的笛卡尔积</span><br></code></pre></td></tr></table></figure>

<h2 id="2、连接查询"><a href="#2、连接查询" class="headerlink" title="2、连接查询"></a>2、连接查询</h2><h3 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h3><blockquote>
<p>查询两张表中符合条件的数据，不符合条件的不会返回结果</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 内连接演示</span><br><span class="hljs-comment">-- 查询员工姓名，并查询关联部门的名称（隐式内连接实现）</span><br><span class="hljs-comment">-- 表结构：emp，dept</span><br><span class="hljs-comment">-- 条件：emp.dept_id = dept.id</span><br><br># <span class="hljs-keyword">select</span> emp.name, dept.name<br># <span class="hljs-keyword">from</span> emp,<br>#      dept<br># <span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> dept.id;<br><span class="hljs-comment">-- 给表起别名，起了别名后不能用原名</span><br><span class="hljs-keyword">select</span> e.name, d.name<br><span class="hljs-keyword">from</span> emp e,<br>dept d<br><span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> d.id;<br><br><br><span class="hljs-comment">-- 查询员工姓名，并查询关联部门的名称（显式内连接实现） -- inner join...on... inner可以省略，on后面接条件</span><br><span class="hljs-comment">-- 表结构：emp，dept</span><br><span class="hljs-comment">-- 条件：emp.dept_id = dept.id</span><br><br><span class="hljs-keyword">select</span> e.name, d.name<br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> e.dept_id <span class="hljs-operator">=</span> d.id;<br></code></pre></td></tr></table></figure>

<h3 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h3><blockquote>
<p>左外连接：查询&#x3D;&#x3D;左表所有数据&#x3D;&#x3D;和&#x3D;&#x3D;右表中符合条件的数据&#x3D;&#x3D;</p>
<p>右外连接：查询左表所有数据和右表中符合条件的数据</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 外连接演示</span><br><span class="hljs-comment">-- 表结构：emp,dept</span><br><span class="hljs-comment">-- 条件：emp.dept_id = dept.id</span><br><br><span class="hljs-comment">-- 左外连接：查询左表所有数据和右、左表相交的数据 left [outer] join...on... outer可以省略，on后面接条件</span><br><span class="hljs-comment">-- 查询所有员工信息和对应部门信息</span><br><span class="hljs-keyword">select</span> e.name, d.name<br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> d.id <span class="hljs-operator">=</span> e.dept_id;<br><br><span class="hljs-comment">-- 查询右表所有数据和左、右表相交的数据</span><br><span class="hljs-keyword">select</span> d.<span class="hljs-operator">*</span>, e.<span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">right</span> <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> d.id <span class="hljs-operator">=</span> e.dept_id;<br><span class="hljs-comment">-- 左外连接和右外连接可以互相转化，表的顺序换一下就行了（习惯上左外连接）</span><br></code></pre></td></tr></table></figure>

<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 自连接（自连接时要给表起别名用于区分哪张表）</span><br><br><span class="hljs-comment">-- 表结构：emp</span><br><span class="hljs-comment">-- 内自连接</span><br><span class="hljs-comment">-- 查询员工及其所属领导的名字</span><br><span class="hljs-keyword">select</span> e1.name, e2.name<br><span class="hljs-keyword">from</span> emp e1,<br>emp e2<br><span class="hljs-keyword">where</span> e1.managerid <span class="hljs-operator">=</span> e2.id;<br><br><span class="hljs-comment">-- 外自连接</span><br><span class="hljs-comment">-- 查询员工及其所属领导的名字，没有领导也要查询出来</span><br><span class="hljs-keyword">select</span> a.name <span class="hljs-string">&#x27;员工&#x27;</span>, b.name <span class="hljs-string">&#x27;领导&#x27;</span><br><span class="hljs-keyword">from</span> emp a<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> emp b <span class="hljs-keyword">on</span> a.managerid <span class="hljs-operator">=</span> b.id;<br></code></pre></td></tr></table></figure>

<h2 id="union查询"><a href="#union查询" class="headerlink" title="union查询"></a>union查询</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 联合查询 union ，union all</span><br><span class="hljs-comment">-- 将薪资低于5000和年龄大于50的员工全部查询出来</span><br><br><span class="hljs-comment">-- union all 相当于把两张表直接加起来，所以有可能有重复的员工</span><br><span class="hljs-keyword">select</span> name<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&lt;</span> <span class="hljs-number">5000</span><br><span class="hljs-keyword">union</span> <span class="hljs-keyword">all</span><br><span class="hljs-keyword">select</span> name<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-operator">&gt;</span> <span class="hljs-number">50</span>;<br><br><span class="hljs-comment">-- union 对union all结果去重</span><br><span class="hljs-keyword">select</span> name<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&lt;</span> <span class="hljs-number">5000</span><br><span class="hljs-keyword">union</span><br><span class="hljs-keyword">select</span> name<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> age <span class="hljs-operator">&gt;</span> <span class="hljs-number">50</span>;<br><br><span class="hljs-comment">-- 查询的列数必须相同，字段类型也必须相同</span><br></code></pre></td></tr></table></figure>

<h2 id="3、子查询"><a href="#3、子查询" class="headerlink" title="3、子查询"></a>3、子查询</h2><h3 id="标量子查询"><a href="#标量子查询" class="headerlink" title="标量子查询"></a>标量子查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 标量子查询:后一个select查询的结果为单个值</span><br><span class="hljs-comment">-- 常用操作符:&gt; &lt; &lt;&gt; &gt;= = &lt;=</span><br><span class="hljs-comment">-- 查询 销售部 所有员工信息</span><br><span class="hljs-comment">-- a.先查询销售部门id</span><br><span class="hljs-keyword">select</span> id<br><span class="hljs-keyword">from</span> dept<br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;销售部&#x27;</span>;<br><span class="hljs-comment">-- b.根据销售部门id查出员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;销售部&#x27;</span>);<br><br><br><span class="hljs-comment">-- 查询在 方东白 入职之后的员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> entrydate <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">select</span> entrydate <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;方东白&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h3 id="列子查询"><a href="#列子查询" class="headerlink" title="列子查询"></a>列子查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 列子查询</span><br><span class="hljs-comment">-- 1、查询 销售部 和 市场部 的所有员工信息</span><br><br><span class="hljs-comment">-- a.先查询 销售部 和 市场部 的id</span><br><span class="hljs-keyword">select</span> id<br><span class="hljs-keyword">from</span> dept<br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;销售部&#x27;</span><br><span class="hljs-keyword">or</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;市场部&#x27;</span>;<br><br><span class="hljs-comment">-- b.根据id查询员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;销售部&#x27;</span> <span class="hljs-keyword">or</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;市场部&#x27;</span>);<br><br><span class="hljs-comment">-- 2、查询工资比财务部所有员工工资都高的员工</span><br><br><span class="hljs-comment">-- a.查询财务部所有人的工资</span><br><span class="hljs-keyword">select</span> salary<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;财务部&#x27;</span>);<br><span class="hljs-comment">-- b.根据上述信息查询比财务部所有人工资都高的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">all</span> (<span class="hljs-keyword">select</span> salary <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;财务部&#x27;</span>));<br><span class="hljs-comment">--  &gt; all :大于后面查询到的所有数据</span><br><br><span class="hljs-comment">-- 3、查询比研发部至少一人工资高的员工 任意一人：研发部至少存在一个人的工资比我低</span><br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">any</span><br>(<span class="hljs-keyword">select</span> salary <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;研发部&#x27;</span>));<br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> <span class="hljs-keyword">some</span><br>(<span class="hljs-keyword">select</span> salary <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;研发部&#x27;</span>));<br><br><span class="hljs-comment">-- any和some等同</span><br></code></pre></td></tr></table></figure>

<h3 id="行子查询"><a href="#行子查询" class="headerlink" title="行子查询"></a>行子查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 行子查询</span><br><span class="hljs-comment">-- 查询与 张无忌 薪资和直属领导相同的员工信息</span><br><br><span class="hljs-comment">-- a.查询张无忌的薪资和直属领导</span><br><span class="hljs-keyword">select</span> salary, managerid<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张无忌&#x27;</span><br><br><br><span class="hljs-comment">-- b.查询与 张无忌 薪资和直属领导相同的员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> (salary, managerid) <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> salary, managerid <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张无忌&#x27;</span>);<br></code></pre></td></tr></table></figure>

<h3 id="表子查询"><a href="#表子查询" class="headerlink" title="表子查询"></a>表子查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 表子查询</span><br><span class="hljs-comment">-- 查询和 鹿杖客 宋远桥 职位和薪资相同的员工信息</span><br><br><span class="hljs-comment">-- a.查询鹿杖客 宋远桥 的职位和薪资</span><br><span class="hljs-keyword">select</span> job, salary<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> name <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;鹿杖客&#x27;</span>, <span class="hljs-string">&#x27;宋远桥&#x27;</span>);<br><br><span class="hljs-comment">-- b.查询和 鹿杖客 宋远桥 职位和薪资相同的员工信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> (job, salary) <span class="hljs-keyword">in</span> (<span class="hljs-keyword">select</span> job, salary <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> name <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;鹿杖客&#x27;</span>, <span class="hljs-string">&#x27;宋远桥&#x27;</span>));<br><br><span class="hljs-comment">-- 查询入职时间是‘2006-01-01’之后的员工及其部门信息</span><br><span class="hljs-comment">-- a.查询入职时间是‘2006-01-01’之后的员工</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> entrydate <span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;2006-01-01&#x27;</span>;<br><span class="hljs-comment">-- b.查询这些员工的部门信息</span><br><span class="hljs-comment">-- 把上述查询的结果当做需要查询的一张表</span><br><span class="hljs-keyword">select</span> e.<span class="hljs-operator">*</span>, d.<span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> entrydate <span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;2006-01-01&#x27;</span>) e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> e.dept_id <span class="hljs-operator">=</span> d.id;<br></code></pre></td></tr></table></figure>

<h2 id="4、多表查询案例"><a href="#4、多表查询案例" class="headerlink" title="4、多表查询案例"></a>4、多表查询案例</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- ---------------&gt;多表查询案例 &lt;--------------</span><br><span class="hljs-comment">-- 准备数据</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> salgrade<br>(<br>grade <span class="hljs-type">int</span>,<br>losal <span class="hljs-type">int</span>,<br>hisal <span class="hljs-type">int</span><br>) comment <span class="hljs-string">&#x27;薪资等级表&#x27;</span>;<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">1</span>, <span class="hljs-number">0</span>, <span class="hljs-number">3000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">2</span>, <span class="hljs-number">3001</span>, <span class="hljs-number">5000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">3</span>, <span class="hljs-number">5001</span>, <span class="hljs-number">8000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">4</span>, <span class="hljs-number">8001</span>, <span class="hljs-number">10000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">5</span>, <span class="hljs-number">10001</span>, <span class="hljs-number">15000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">6</span>, <span class="hljs-number">15001</span>, <span class="hljs-number">20000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">7</span>, <span class="hljs-number">20001</span>, <span class="hljs-number">25000</span>);<br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> salgrade<br><span class="hljs-keyword">values</span> (<span class="hljs-number">8</span>, <span class="hljs-number">25001</span>, <span class="hljs-number">30000</span>);<br><br><br><span class="hljs-comment">-- 1.查询员工的姓名、年龄、职位、部门信息。</span><br><span class="hljs-keyword">select</span> e.name, e.age, e.job, d.<span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> e.dept_id <span class="hljs-operator">=</span> d.id;<br><br><span class="hljs-comment">-- 2.查询年龄小于30岁的员工姓名、年龄、职位、部门信息。</span><br><span class="hljs-keyword">select</span> e.name, e.age, e.job, d.<span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> e.dept_id <span class="hljs-operator">=</span> d.id<br><span class="hljs-keyword">where</span> e.age <span class="hljs-operator">&lt;</span> <span class="hljs-number">30</span>;<br><br><span class="hljs-comment">-- 3.查询拥有员工的部门ID、部门名称。</span><br><span class="hljs-keyword">select</span> <span class="hljs-keyword">distinct</span> d.id, d.name<br><span class="hljs-keyword">from</span> dept d,<br>emp e<br><span class="hljs-keyword">where</span> d.id <span class="hljs-operator">=</span> e.dept_id;<br><br><span class="hljs-comment">-- 4.查询所有年龄大于40岁的员工，及其归属的部门名称：如果员工没有分配部门，也需要展示出来。</span><br><span class="hljs-keyword">select</span> e.<span class="hljs-operator">*</span>, d.name<br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> dept d <span class="hljs-keyword">on</span> e.dept_id <span class="hljs-operator">=</span> d.id<br><span class="hljs-keyword">where</span> e.age <span class="hljs-operator">&gt;</span> <span class="hljs-number">40</span>;<br><br><span class="hljs-comment">-- 5.查询所有员工的工资等级。</span><br><span class="hljs-keyword">select</span> e.name, e.salary, s.losal, s.hisal, s.grade<br><span class="hljs-keyword">from</span> emp e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> salgrade s <span class="hljs-keyword">on</span> e.salary <span class="hljs-keyword">between</span> s.losal <span class="hljs-keyword">and</span> s.hisal;<br><br><span class="hljs-comment">-- 6.查询&quot;研发部”所有员工的信息及工资等级。</span><br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp e,<br>salgrade s,<br>dept d<br><span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> d.id<br><span class="hljs-keyword">and</span> e.salary <span class="hljs-keyword">between</span> s.losal <span class="hljs-keyword">and</span> s.hisal<br><span class="hljs-keyword">and</span> d.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;研发部&#x27;</span>;<br><br><span class="hljs-keyword">select</span> e.<span class="hljs-operator">*</span>, grade<br><span class="hljs-keyword">from</span> (<span class="hljs-keyword">select</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">from</span> emp e <span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> (<span class="hljs-keyword">select</span> id <span class="hljs-keyword">from</span> dept d <span class="hljs-keyword">where</span> d.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;研发部&#x27;</span>)) e<br>   <span class="hljs-keyword">left</span> <span class="hljs-keyword">join</span> salgrade s <span class="hljs-keyword">on</span> e.salary <span class="hljs-operator">&lt;=</span> s.hisal <span class="hljs-keyword">and</span> e.salary <span class="hljs-operator">&gt;=</span> s.losal;<br><br><span class="hljs-comment">-- 7.查询&quot;研发部”员工的平均工资。</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(e.salary)<br><span class="hljs-keyword">from</span> emp e,<br>dept d<br><span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> d.id<br><span class="hljs-keyword">and</span> d.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;研发部&#x27;</span>;<br><br><span class="hljs-comment">-- 8.查询工资比&quot;灭绝&quot;高的员工信息。</span><br><span class="hljs-comment">-- 子查询</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">select</span> salary <span class="hljs-keyword">from</span> emp <span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;灭绝&#x27;</span>);<br><br><span class="hljs-comment">-- 自查询</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp a,<br>emp b<br><span class="hljs-keyword">where</span> a.salary <span class="hljs-operator">&gt;</span> b.salary<br><span class="hljs-keyword">and</span> b.name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;灭绝&#x27;</span>;<br><br><span class="hljs-comment">-- 9.查询比平均薪资高的员工信息。</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(salary)<br><span class="hljs-keyword">from</span> emp;<br><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> salary <span class="hljs-operator">&gt;</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(salary) <span class="hljs-keyword">from</span> emp);<br><br><span class="hljs-comment">-- 10.查询低于本部门平均工资的员工信息。</span><br><span class="hljs-comment">-- 查询某部门平均薪资</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(e.salary)<br><span class="hljs-keyword">from</span> emp e,<br>dept d<br><span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> d.id<br><span class="hljs-keyword">and</span> d.id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-comment">-- 查询低于本部门平均工资的员工信息。</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> emp e1<br><span class="hljs-keyword">where</span> e1.salary <span class="hljs-operator">&lt;</span> (<span class="hljs-keyword">select</span> <span class="hljs-built_in">avg</span>(e2.salary)<br>             <span class="hljs-keyword">from</span> emp e2,<br>                  dept d<br>             <span class="hljs-keyword">where</span> e2.dept_id <span class="hljs-operator">=</span> d.id<br>               <span class="hljs-keyword">and</span> d.id <span class="hljs-operator">=</span> e1.dept_id);<br><br><span class="hljs-comment">-- 11.查询所有的部门信息，并统计部门的员工人数。</span><br><span class="hljs-comment">-- 查询所有部门信息</span><br><span class="hljs-keyword">select</span> <span class="hljs-operator">*</span><br><span class="hljs-keyword">from</span> dept;<br><span class="hljs-comment">-- 统计1号部门员工数量</span><br><span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>)<br><span class="hljs-keyword">from</span> emp<br><span class="hljs-keyword">where</span> dept_id <span class="hljs-operator">=</span> <span class="hljs-number">1</span>;<br><span class="hljs-comment">-- 查询所有的部门信息，并统计部门的员工人数</span><br><span class="hljs-keyword">select</span> d.id, d.name, (<span class="hljs-keyword">select</span> <span class="hljs-built_in">count</span>(<span class="hljs-operator">*</span>) <span class="hljs-keyword">from</span> emp e <span class="hljs-keyword">where</span> e.dept_id <span class="hljs-operator">=</span> d.id) <span class="hljs-string">&#x27;人数&#x27;</span><br><span class="hljs-keyword">from</span> dept d;<br></code></pre></td></tr></table></figure>

<h1 id="八、事务"><a href="#八、事务" class="headerlink" title="八、事务"></a>八、事务</h1><h2 id="1、事务简介"><a href="#1、事务简介" class="headerlink" title="1、事务简介"></a>1、事务简介</h2><blockquote>
<p>事务 是一组操作的集合，它是一个不可分割的工作单位，事务会把所有的操作作为一个整体一起向系 统提交或撤销操作请求，即这些操作要么同时成功，要么同时失败。</p>
</blockquote>
<h2 id="2、事务操作"><a href="#2、事务操作" class="headerlink" title="2、事务操作"></a>2、事务操作</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 事务</span><br><br><span class="hljs-comment">-- ---&gt; 准备数据 &lt;---------------------</span><br><span class="hljs-keyword">create</span> <span class="hljs-keyword">table</span> account<br>(<br>id    <span class="hljs-type">int</span> <span class="hljs-keyword">primary</span> key AUTO_INCREMENT comment <span class="hljs-string">&#x27;ID&#x27;</span>,<br>name  <span class="hljs-type">varchar</span>(<span class="hljs-number">10</span>) comment <span class="hljs-string">&#x27;姓名&#x27;</span>,<br>money <span class="hljs-keyword">double</span>(<span class="hljs-number">10</span>, <span class="hljs-number">2</span>) comment <span class="hljs-string">&#x27;余额&#x27;</span><br>) comment <span class="hljs-string">&#x27;账户表&#x27;</span>;<br><br><span class="hljs-keyword">insert</span> <span class="hljs-keyword">into</span> account(name, money)<br><span class="hljs-keyword">VALUES</span> (<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-number">2000</span>),<br> (<span class="hljs-string">&#x27;李四&#x27;</span>, <span class="hljs-number">2000</span>);<br><br><span class="hljs-comment">-- -----------------------------------</span><br><br><span class="hljs-comment">-- 恢复数据操作</span><br><span class="hljs-keyword">update</span> account<br><span class="hljs-keyword">set</span> money <span class="hljs-operator">=</span> <span class="hljs-number">2000</span><br><span class="hljs-keyword">where</span> name <span class="hljs-keyword">in</span> (<span class="hljs-string">&#x27;张三&#x27;</span>, <span class="hljs-string">&#x27;李四&#x27;</span>);<br><br><br><span class="hljs-keyword">select</span> @<span class="hljs-variable">@autocommit</span>; <span class="hljs-comment">-- 查询事务提交方式 0-手动 1-自动</span><br><br><span class="hljs-comment">-- 方式一</span><br><span class="hljs-keyword">set</span> @<span class="hljs-variable">@autocommit</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">-- 设置为手动提交</span><br><br><br><span class="hljs-comment">-- 转账操作（张三转给李四1000元）</span><br><span class="hljs-comment">-- 查询张三余额</span><br><span class="hljs-keyword">select</span> money<br><span class="hljs-keyword">from</span> account<br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张三&#x27;</span>;<br><br><span class="hljs-comment">-- 张三余额-1000</span><br><span class="hljs-keyword">update</span> account<br><span class="hljs-keyword">set</span> money <span class="hljs-operator">=</span> money <span class="hljs-operator">-</span> <span class="hljs-number">1000</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张三&#x27;</span>;<br><br><span class="hljs-comment">-- 若此处出现异常，则张三-1000元，但李四并没有+1000元</span><br>异常... <span class="hljs-comment">-- 模拟出错场景</span><br><br><span class="hljs-comment">-- 李四余额+1000</span><br><span class="hljs-keyword">update</span> account<br><span class="hljs-keyword">set</span> money <span class="hljs-operator">=</span> money <span class="hljs-operator">+</span> <span class="hljs-number">1000</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;李四&#x27;</span>;<br><br><span class="hljs-comment">-- 提交事务</span><br><span class="hljs-keyword">commit</span>;<br><span class="hljs-comment">-- 回滚事务</span><br><span class="hljs-keyword">rollback</span>;<br><br><span class="hljs-comment">-- 方式二</span><br><br><span class="hljs-keyword">set</span> @<span class="hljs-variable">@autocommit</span> <span class="hljs-operator">=</span> <span class="hljs-number">1</span>; <span class="hljs-comment">-- 设置为自动提交</span><br><br><span class="hljs-keyword">start</span> transaction;<br><br><span class="hljs-comment">-- 转账操作（张三转给李四1000元）</span><br><span class="hljs-comment">-- 查询张三余额</span><br><span class="hljs-keyword">select</span> money<br><span class="hljs-keyword">from</span> account<br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张三&#x27;</span>;<br><br><span class="hljs-comment">-- 张三余额-1000</span><br><span class="hljs-keyword">update</span> account<br><span class="hljs-keyword">set</span> money <span class="hljs-operator">=</span> money <span class="hljs-operator">-</span> <span class="hljs-number">1000</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;张三&#x27;</span>;<br><br><span class="hljs-comment">-- 若此处出现异常，则张三-1000元，但李四并没有+1000元</span><br>异常...   <span class="hljs-comment">-- 模拟出错场景</span><br><br><span class="hljs-comment">-- 李四余额+1000</span><br><span class="hljs-keyword">update</span> account<br><span class="hljs-keyword">set</span> money <span class="hljs-operator">=</span> money <span class="hljs-operator">+</span> <span class="hljs-number">1000</span><br><span class="hljs-keyword">where</span> name <span class="hljs-operator">=</span> <span class="hljs-string">&#x27;李四&#x27;</span>;<br><br><span class="hljs-comment">-- 提交事务</span><br><span class="hljs-keyword">commit</span>;<br><span class="hljs-comment">-- 回滚事务</span><br><span class="hljs-keyword">rollback</span>;<br></code></pre></td></tr></table></figure>

<h2 id="3、事务的四大特性（ACID）"><a href="#3、事务的四大特性（ACID）" class="headerlink" title="3、事务的四大特性（ACID）"></a>3、事务的四大特性（ACID）</h2><blockquote>
<ol>
<li><strong>原子性（Atomicity）：事务是不可分割的最小操作单元，要么全部成功，要么全部失败。</strong></li>
</ol>
</blockquote>
<blockquote>
<ol start="2">
<li><p><strong>一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。</strong> </p>
</li>
<li><p><strong>一致性（Consistency）：事务完成时，必须使所有的数据都保持一致状态。</strong></p>
</li>
</ol>
</blockquote>
<blockquote>
<ol start="3">
<li><p><strong>隔离性（Isolation）：数据库系统提供的隔离机制，保证事务在不受外部并发操作影响的独立 环境下运行。</strong> </p>
</li>
<li><p><strong>持久性（Durability）：事务一旦提交或回滚，它对数据库中的数据的改变就是永久的。</strong></p>
</li>
</ol>
</blockquote>
<h2 id="4、并发事务问题"><a href="#4、并发事务问题" class="headerlink" title="4、并发事务问题"></a>4、并发事务问题</h2><blockquote>
<p><strong>脏读：一个事务读取到另外一个事务未提交的数据。</strong></p>
<p><strong>不可重复读：一个事务先后读取同一条数据，但两次读取到的数据不同。</strong></p>
<p><strong>幻读：一个事务查询数据时没有对应数据，插入该数据时又发现该数据已经存在，好像出现“幻影”。</strong></p>
</blockquote>
<h2 id="5、隔离级别"><a href="#5、隔离级别" class="headerlink" title="5、隔离级别"></a>5、隔离级别</h2><figure class="highlight sql"><table><tr><td class="code"><pre><code class="hljs sql"><span class="hljs-comment">-- 并发事务与隔离级别</span><br><br><span class="hljs-comment">-- 查询事务隔离级别</span><br><span class="hljs-keyword">select</span> @<span class="hljs-variable">@transaction_isolation</span>;<br><br><span class="hljs-comment">-- 设置事务隔离级别 session-仅当前页面起作用    transaction isolation level-事务隔离级别</span><br><span class="hljs-keyword">set</span> session transaction isolation level read uncommitted;<br><br><span class="hljs-comment">-- repeatable read是默认级别</span><br><span class="hljs-keyword">set</span> session transaction isolation level repeatable read ;<br><br><span class="hljs-comment">-- 隔离级别越高，数据越安全，但是性能越低</span><br></code></pre></td></tr></table></figure>

<h1 id="九、JDBC"><a href="#九、JDBC" class="headerlink" title="九、JDBC"></a>九、JDBC</h1><h2 id="1、jdbc7步编程"><a href="#1、jdbc7步编程" class="headerlink" title="1、jdbc7步编程"></a>1、jdbc7步编程</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//JDBC快速入门</span><br><span class="hljs-comment">//1、注册驱动</span><br>Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br><br><span class="hljs-comment">//2、获取连接</span><br><span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br><span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br><span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>conn = DriverManager.getConnection(url, username, password);<br><br><br><span class="hljs-comment">//3、定义sql</span><br><span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update account set money = 666 where id = 1&quot;</span>;<br><br><span class="hljs-comment">//4、获取执行sql的对象 Statement</span><br><span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>stmt = conn.createStatement();<br><br><br><span class="hljs-comment">//5、执行sql</span><br><span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//受影响的行数</span><br>count = stmt.executeUpdate(sql);<br><br><br><span class="hljs-comment">//6、处理结果</span><br>System.out.println(<span class="hljs-string">&quot;受影响的行数有&quot;</span> + count + <span class="hljs-string">&quot;行&quot;</span>);<br><br><span class="hljs-comment">//7、释放资源</span><br>stmt.close();<br>conn.close();<br></code></pre></td></tr></table></figure>

<h2 id="2、DriverManager"><a href="#2、DriverManager" class="headerlink" title="2、DriverManager"></a>2、DriverManager</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java">  <span class="hljs-comment">//1、注册驱动 --&gt;可以省略</span><br>  <span class="hljs-comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><br>  <span class="hljs-comment">//2、获取连接 --&gt;如果连接的是本机的数据库且端口是默认的 3306 则可以简写</span><br>  <span class="hljs-comment">// String url = &quot;jdbc:mysql://localhost:3306/clb&quot;;</span><br>  <span class="hljs-comment">//简写：</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql:/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> DriverManager.getConnection(url, username, password);<br><br><br>  <span class="hljs-comment">//3、定义sql</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update account set money = 1000 where id = 1&quot;</span>;<br><br>  <span class="hljs-comment">//4、获取执行sql的对象 Statement</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  stmt = conn.createStatement();<br><br><br>  <span class="hljs-comment">//5、执行sql</span><br>  <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//受影响的行数</span><br>  count = stmt.executeUpdate(sql);<br><br><br>  <span class="hljs-comment">//6、处理结果</span><br>  System.out.println(<span class="hljs-string">&quot;受影响的行数有&quot;</span> + count + <span class="hljs-string">&quot;行&quot;</span>);<br><br>  <span class="hljs-comment">//7、释放资源</span><br><br>  stmt.close();<br>  conn.close();<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    DriverManager有两个作用:</span><br><span class="hljs-comment">    1、注册驱动</span><br><span class="hljs-comment">    2、获取数据库连接</span><br><span class="hljs-comment">*/</span><br></code></pre></td></tr></table></figure>

<h2 id="3、Connection"><a href="#3、Connection" class="headerlink" title="3、Connection"></a>3、Connection</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//1、管理事务       </span><br><span class="hljs-keyword">try</span> &#123;<br>    <span class="hljs-comment">//开启事务</span><br>    conn.setAutoCommit(<span class="hljs-literal">false</span>);<span class="hljs-comment">//将自动提交改为手动</span><br><br>    <span class="hljs-comment">//5、执行sql</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> stmt.executeUpdate(sql);<br>    <span class="hljs-comment">//6、处理结果</span><br>    System.out.println(<span class="hljs-string">&quot;受影响的行数有&quot;</span> + count + <span class="hljs-string">&quot;行&quot;</span>);<br><br>    <span class="hljs-comment">//制造异常</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">i</span> <span class="hljs-operator">=</span> <span class="hljs-number">3</span> / <span class="hljs-number">0</span>;<br><br>    <span class="hljs-comment">//5、执行sql</span><br>    <span class="hljs-type">int</span> <span class="hljs-variable">count2</span> <span class="hljs-operator">=</span> stmt.executeUpdate(sql2);<br>    <span class="hljs-comment">//6、处理结果</span><br>    System.out.println(<span class="hljs-string">&quot;受影响的行数有&quot;</span> + count2 + <span class="hljs-string">&quot;行&quot;</span>);<br><br>    <span class="hljs-comment">//提交事务</span><br>    conn.commit();<br>&#125; <span class="hljs-keyword">catch</span> (Exception e) &#123;<br>    <span class="hljs-comment">//回滚事务</span><br>    conn.rollback();<br>    e.printStackTrace();<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="4、Statement"><a href="#4、Statement" class="headerlink" title="4、Statement"></a>4、Statement</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> JDBC;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo3Statement</span> &#123;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  Statement:</span><br><span class="hljs-comment">  1、执行SQL语句</span><br><span class="hljs-comment">  int executeUpdate(sql) -&gt; 执行DML、DDL语句</span><br><span class="hljs-comment">  执行DML语句</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDML</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  <span class="hljs-comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br><br><br>  <span class="hljs-comment">//3、定义sql</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;update account set money = 666 where id = 1&quot;</span>;<br><br>  <span class="hljs-comment">//4、获取执行sql的对象 Statement</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br><br>  <span class="hljs-comment">//5、执行sql</span><br>  <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> stmt.executeUpdate(sql);<br><br>  <span class="hljs-comment">//6、处理结果</span><br>  System.out.println(count &gt; <span class="hljs-number">0</span> ? <span class="hljs-string">&quot;修改成功&quot;</span> : <span class="hljs-string">&quot;修改失败&quot;</span>);<br><br>  <span class="hljs-comment">//7、释放资源</span><br>  stmt.close();<br>  conn.close();<br>&#125;<br><br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  执行DDL语句</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">testDDL</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  <span class="hljs-comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br><br>  <span class="hljs-comment">//3、定义sql</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;drop database cxk&quot;</span>;<br><br>  <span class="hljs-comment">//4、获取执行sql的对象 Statement</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br><br>  <span class="hljs-comment">//5、执行sql</span><br>  <span class="hljs-type">int</span> <span class="hljs-variable">count</span> <span class="hljs-operator">=</span> stmt.executeUpdate(sql);<br><br>  <span class="hljs-comment">//6、处理结果</span><br><span class="hljs-comment">//        System.out.println(count &gt; 0 ? &quot;修改成功&quot; : &quot;修改失败&quot;);</span><br>  System.out.println(count);<br><br>  <span class="hljs-comment">//7、释放资源</span><br><br>  stmt.close();<br>  conn.close();<br>&#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="5、ResultSet"><a href="#5、ResultSet" class="headerlink" title="5、ResultSet"></a>5、ResultSet</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> JDBC;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> pojo.Account;<br><br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><span class="hljs-keyword">import</span> java.util.ArrayList;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">Demo4ResultSet</span> &#123;<br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  ResultSet:</span><br><span class="hljs-comment">  执行DQL查询语句</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ResultSetDemo</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  <span class="hljs-comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br>  <span class="hljs-comment">//3、定义sql语句</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from account&quot;</span>;<br>  <span class="hljs-comment">//4、获取statement对象</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>  <span class="hljs-comment">//5、执行sql</span><br>  <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br><br>  <span class="hljs-comment">//6、处理数据，遍历rs中的所有数据</span><br>  <span class="hljs-comment">//6.1光标向下移动一行，判断当前行是否有数据</span><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  while (rs.next()) &#123;</span><br><span class="hljs-comment">      //6.2 获取数据getXxx()</span><br><span class="hljs-comment">      int id = rs.getInt(1);</span><br><span class="hljs-comment">      String name = rs.getString(2);</span><br><span class="hljs-comment">      double money = rs.getDouble(3);</span><br><span class="hljs-comment"></span><br><span class="hljs-comment">      System.out.println(id);</span><br><span class="hljs-comment">      System.out.println(name);</span><br><span class="hljs-comment">      System.out.println(money);</span><br><span class="hljs-comment">      System.out.println(&quot;-------------------&quot;);</span><br><span class="hljs-comment">  &#125;</span><br><span class="hljs-comment">   */</span><br>  <span class="hljs-keyword">while</span> (rs.next()) &#123;<br>      <span class="hljs-comment">//6.2 获取数据getXxx()</span><br>      <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> rs.getInt(<span class="hljs-string">&quot;id&quot;</span>);<br>      <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>      <span class="hljs-type">double</span> <span class="hljs-variable">money</span> <span class="hljs-operator">=</span> rs.getDouble(<span class="hljs-string">&quot;money&quot;</span>);<br><br>      System.out.println(id);<br>      System.out.println(name);<br>      System.out.println(money);<br>      System.out.println(<span class="hljs-string">&quot;-------------------&quot;</span>);<br>  &#125;<br><br>  <span class="hljs-comment">//7、释放资源</span><br>  rs.close();<br>  stmt.close();<br>  conn.close();<br>&#125;<br><br>  <span class="hljs-comment">/*</span><br><span class="hljs-comment">  查询数据库中account表的数据，封装成Account对象，并存储到ArrayList表中</span><br><span class="hljs-comment">  1、定义实体类Account</span><br><span class="hljs-comment">  2、查询数据</span><br><span class="hljs-comment">  3、封装数据到ArrayList表中</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">ResultSetDemo2</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  <span class="hljs-comment">//Class.forName(&quot;com.mysql.cj.jdbc.Driver&quot;);</span><br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br>  <span class="hljs-comment">//3、定义sql语句</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from account&quot;</span>;<br>  <span class="hljs-comment">//4、获取statement对象</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br>  <span class="hljs-comment">//5、执行sql</span><br>  <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br><br>  ArrayList&lt;Account&gt; lst = <span class="hljs-keyword">new</span> <span class="hljs-title class_">ArrayList</span>&lt;&gt;();<br><br>  <span class="hljs-keyword">while</span> (rs.next()) &#123;<br>      <span class="hljs-comment">//6.2 获取数据getXxx()</span><br>      <span class="hljs-type">int</span> <span class="hljs-variable">id</span> <span class="hljs-operator">=</span> rs.getInt(<span class="hljs-string">&quot;id&quot;</span>);<br>      <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> rs.getString(<span class="hljs-string">&quot;name&quot;</span>);<br>      <span class="hljs-type">double</span> <span class="hljs-variable">money</span> <span class="hljs-operator">=</span> rs.getDouble(<span class="hljs-string">&quot;money&quot;</span>);<br>      lst.add(<span class="hljs-keyword">new</span> <span class="hljs-title class_">Account</span>(id, name, money));<br>  &#125;<br><br>  System.out.println(lst);<br><br>  <span class="hljs-comment">//7、释放资源</span><br>  rs.close();<br>  stmt.close();<br>  conn.close();<br>&#125;<br><br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="6、用户登陆"><a href="#6、用户登陆" class="headerlink" title="6、用户登陆"></a>6、用户登陆</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> JDBC;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.sql.DriverManager;<br><span class="hljs-keyword">import</span> java.sql.ResultSet;<br><span class="hljs-keyword">import</span> java.sql.Statement;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">用户登陆</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">UserLoginDemo5</span> &#123;<br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">UserLogin</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br><br>  <span class="hljs-comment">//接收用户名和密码</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;cxk&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">pwd</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jntm&quot;</span>;<br><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from tb_user where name = &#x27;&quot;</span> + name + <span class="hljs-string">&quot;&#x27; and password = &#x27;&quot;</span> + pwd + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br><br>  <span class="hljs-comment">//获取Statement对象</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br><br>  <span class="hljs-comment">//执行sql语句</span><br>  <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br><br>  <span class="hljs-comment">//判断是否登陆成功</span><br>  System.out.println(rs.next() ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>);<br><br>  <span class="hljs-comment">//7、释放资源</span><br>  rs.close();<br>  stmt.close();<br>  conn.close();<br>&#125;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">  sql注入问题</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-meta">@Test</span><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">UserLogin_Inject</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>  <span class="hljs-comment">//1、注册驱动</span><br>  Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br><br>  <span class="hljs-comment">//2、获取连接</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql://localhost:3306/clb&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>  <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>  conn = DriverManager.getConnection(url, username, password);<br><br>  <span class="hljs-comment">//接收用户名和密码 sql注入-&gt;此处密码错误却还能成功登陆</span><br>  <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ikunngmngmngm&quot;</span>;<br>  <span class="hljs-type">String</span> <span class="hljs-variable">pwd</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#x27;or &#x27;1&#x27; = &#x27;1&quot;</span>;<br><br>  <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from tb_user where name = &#x27;&quot;</span> + name + <span class="hljs-string">&quot;&#x27; and password = &#x27;&quot;</span> + pwd + <span class="hljs-string">&quot;&#x27;&quot;</span>;<br><br>  <span class="hljs-comment">//获取Statement对象</span><br>  <span class="hljs-type">Statement</span> <span class="hljs-variable">stmt</span> <span class="hljs-operator">=</span> conn.createStatement();<br><br>  <span class="hljs-comment">//执行sql语句</span><br>  <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> stmt.executeQuery(sql);<br>  System.out.println(<span class="hljs-string">&quot;sql = &quot;</span> + sql);<br><br>  <span class="hljs-comment">//判断是否登陆成功</span><br>  System.out.println(rs.next() ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>);<br><br>  <span class="hljs-comment">//7、释放资源</span><br>  rs.close();<br>  stmt.close();<br>  conn.close();<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="7、PrepareStatement"><a href="#7、PrepareStatement" class="headerlink" title="7、PrepareStatement"></a>7、PrepareStatement</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> JDBC;<br><br><span class="hljs-keyword">import</span> org.junit.Test;<br><br><span class="hljs-keyword">import</span> java.sql.*;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment">    PrepareStatement解决sql注入问题</span><br><span class="hljs-comment">    将sql语句中的敏感符号加\ 进行转义</span><br><span class="hljs-comment">*/</span><br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">PrepareStatementDemo6</span> &#123;<br><br>    <span class="hljs-meta">@Test</span><br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">PrepareStatement</span><span class="hljs-params">()</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">//1、注册驱动</span><br>        Class.forName(<span class="hljs-string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);<br><br>        <span class="hljs-comment">//2、获取连接</span><br>        <span class="hljs-comment">//useSeverPrepStmts=true 开启预编译功能 ：性能更高</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">url</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;jdbc:mysql:/clb?useSSL=false&amp;useSeverPrepStmts=true&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">username</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;root&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">password</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;123456&quot;</span>;<br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">conn</span> <span class="hljs-operator">=</span> <span class="hljs-literal">null</span>;<br>        conn = DriverManager.getConnection(url, username, password);<br><br>        <span class="hljs-comment">//接收用户名和密码 sql注入-&gt;此处密码错误却还能成功登陆</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">name</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;ikunngmngmngm&quot;</span>;<br>        <span class="hljs-type">String</span> <span class="hljs-variable">pwd</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;&#x27;or &#x27;1&#x27; = &#x27;1&quot;</span>;<br><br>        <span class="hljs-comment">//定义sql语句</span><br>        <span class="hljs-type">String</span> <span class="hljs-variable">sql</span> <span class="hljs-operator">=</span> <span class="hljs-string">&quot;select * from tb_user where name = ? and password = ?&quot;</span>;<br><br>        <span class="hljs-comment">//获取Statement对象</span><br>        <span class="hljs-type">PreparedStatement</span> <span class="hljs-variable">pstmt</span> <span class="hljs-operator">=</span> conn.prepareStatement(sql);<br><br>        <span class="hljs-comment">//设置？的值</span><br>        pstmt.setString(<span class="hljs-number">1</span>, name);<br>        pstmt.setString(<span class="hljs-number">2</span>, pwd);<br><br>        <span class="hljs-comment">//执行sql语句</span><br>        <span class="hljs-type">ResultSet</span> <span class="hljs-variable">rs</span> <span class="hljs-operator">=</span> pstmt.executeQuery();<br><br>        <span class="hljs-comment">//判断是否登陆成功</span><br>        System.out.println(rs.next() ? <span class="hljs-string">&quot;登陆成功&quot;</span> : <span class="hljs-string">&quot;登陆失败&quot;</span>);<br><br>        <span class="hljs-comment">//7、释放资源</span><br>        rs.close();<br>        pstmt.close();<br>        conn.close();<br>    &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="8、Druid数据库连接池"><a href="#8、Druid数据库连接池" class="headerlink" title="8、Druid数据库连接池"></a>8、Druid数据库连接池</h2><figure class="highlight java"><table><tr><td class="code"><pre><code class="hljs java"><span class="hljs-keyword">package</span> Druid;<br><br><span class="hljs-comment">/*</span><br><span class="hljs-comment"> * Druid数据库连接池</span><br><span class="hljs-comment"> * */</span><br><br><span class="hljs-keyword">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;<br><br><span class="hljs-keyword">import</span> javax.sql.DataSource;<br><span class="hljs-keyword">import</span> java.io.FileInputStream;<br><span class="hljs-keyword">import</span> java.sql.Connection;<br><span class="hljs-keyword">import</span> java.util.Properties;<br><br><span class="hljs-keyword">public</span> <span class="hljs-keyword">class</span> <span class="hljs-title class_">DruidDemo</span> &#123;<br>    <span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title function_">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> Exception &#123;<br>        <span class="hljs-comment">//1、导入jar包</span><br>        <span class="hljs-comment">//2、定义配置文件</span><br>        <span class="hljs-comment">//3、加载配置文件</span><br><br>        <span class="hljs-comment">//4、获取连接池对象</span><br>        <span class="hljs-type">Properties</span> <span class="hljs-variable">prop</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Properties</span>();<br>        prop.load(<span class="hljs-keyword">new</span> <span class="hljs-title class_">FileInputStream</span>(<span class="hljs-string">&quot;jdbcDemo/src/druid.properties&quot;</span>));<br>        <span class="hljs-type">DataSource</span> <span class="hljs-variable">dataSource</span> <span class="hljs-operator">=</span> DruidDataSourceFactory.createDataSource(prop);<br><br>        <span class="hljs-comment">//5、获取数据库连接</span><br>        <span class="hljs-type">Connection</span> <span class="hljs-variable">connection</span> <span class="hljs-operator">=</span> dataSource.getConnection();<br>        System.out.println(connection);<br><br><br><span class="hljs-comment">//        System.out.println(System.getProperty(&quot;user.dir&quot;));</span><br>    &#125;<br>&#125;<br><br><span class="hljs-comment">//配置文件（根据具体情况配置）</span><br>driverClassName=com.mysql.cj.jdbc.Driver<br>url=jdbc:mysql:/clb?useSSL=<span class="hljs-literal">false</span>&amp;useServerPrepStmts=<span class="hljs-literal">true</span><br>username=root<br>password=<span class="hljs-number">123456</span><br># 初始化连接数量<br>initialSize=<span class="hljs-number">5</span><br># 最大连接数量<br>maxActive=<span class="hljs-number">10</span><br># 最大等待时间-&gt;<span class="hljs-number">3</span>秒<br>maxWait=<span class="hljs-number">30000</span><br></code></pre></td></tr></table></figure>


<h1 id="十、进阶"><a href="#十、进阶" class="headerlink" title="十、进阶"></a>十、进阶</h1><h2 id="1、索引"><a href="#1、索引" class="headerlink" title="1、索引"></a>1、索引</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs mysql">-- 索引<br><br>-- 查询表中所有索引<br>show index from tb_user;<br><br>-- 创建索引:  create index 索引名 on 表名(字段名);<br>-- 给表中name字段创建常规索引<br>create index idx_user_name on tb_user (name);<br><br>-- 给表中phone字段创建唯一索引<br>create unique index idx_user_phone on tb_user (phone);<br><br>-- 给表中profession,age,status创建联合索引,字段的顺序是有讲究的<br>create index idx_user_pro_age_sta on tb_user (profession, age, status);<br><br>-- 给表中email字段创建常规索引<br>create index idx_user_email on tb_user (email);<br><br>-- 删除索引:  drop index 索引名 on 表名;<br>drop index idx_user_email on tb_user;<br><br><br>-- SQL性能分析<br>-- 1、查看各种sql语句的执行频率<br>show global status like &#x27;Com_______&#x27;;<br><br>-- 2、慢查询日志,查询语句执行时间超过指定时间（默认10秒）就会记录到慢查询日志<br>show variables like &#x27;slow_query_log&#x27;;<br><br><br><br>-- 3、profile 详情<br>-- 查看是否支持profiling<br>select @@have_profiling;<br><br>-- 查看profiling是否开启 0-未开启 1-开启<br>select @@profiling;<br><br>-- 开启profiling<br>set profiling = 1;<br><br>select *<br>from tb_user;<br><br><br>-- 查看所有查询语句耗时情况<br>show profiles;<br><br>-- 查看指定查询语句的各个阶段的耗时<br>-- show profile for query 10;<br><br>-- 额外查看sql语句cpu消耗<br>-- show profile cpu for query 10;<br><br><br>-- 4、explain 执行计划<br><br>explain<br>select *<br>from tb_user<br>where id = 1;<br><br><br>-- 索引的使用<br>/**<br>1-最左前缀法则：<br>	最左边的索引必须存在，否则索引全部失效<br> 	如果跳过了某个索引，那么从该索引开始的后面字段的索引失效<br>*/<br><br>show index from tb_user;<br><br>-- 没有跳过索引，索引全部生效<br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;<br>and age = 31<br>and status = &#x27;0&#x27;;<br><br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;<br>and age = 31;<br><br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;;<br><br>-- 跳过最左边的索引，索引全部失效<br>explain<br>select *<br>from tb_user<br>where age = 31<br>and status = &#x27;0&#x27;;<br><br>-- 跳过age索引，后面的status索引失效，前面的profession索引正常<br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;<br>and status = &#x27;0&#x27;;<br><br>-- 查询语句的条件的位置不影响索引是否生效<br>-- 没有跳过任何索引，索引全部生效<br>explain<br>select *<br>from tb_user<br>where status = &#x27;0&#x27;<br>and age = 31<br>and profession = &#x27;软件工程&#x27;;<br><br>/**<br>2-出现范围查询(&gt;,&lt;)时，后面的索引失效,使用&gt;=,&lt;=不会<br>*/<br><br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;<br>and age &gt; 30<br>and status = &#x27;0&#x27;;<br><br>/**<br>3-索引运算<br>    ·不要在索引上进行运算，否则索引失效<br>    ·字符串字段查询时不加单引号，索引失效<br>*/<br><br>explain<br>select *<br>from tb_user<br>where substring(phone, 10, 2) = &#x27;15&#x27;;<br><br>explain<br>select *<br>from tb_user<br>where phone = 17799990004;<br>-- 没用单引号，索引失效<br><br>/**<br>4-模糊匹配<br>    ·后面加%/_模糊匹配，索引正常<br>    ·前面模糊，索引失效<br>*/<br><br>explain<br>select *<br>from tb_user<br>where profession like &#x27;软件%&#x27;; -- 索引有效<br><br><br>explain<br>select *<br>from tb_user<br>where profession like &#x27;%工程&#x27;;<br><br>/**<br>5-or连接的条件<br>    ·只有两个条件都有索引，索引才会生效，否则失效<br>    ·解决方法：建立相关字段的索引<br>*/<br>explain<br>select *<br>from tb_user<br>where phone = &#x27;17799990004&#x27;<br>or age = 31; -- phone有索引，但是age没有索引，索引失效<br><br>explain<br>select *<br>from tb_user<br>where phone = &#x27;17799990004&#x27;<br>or id = 1;<br>-- phone 和 id都有索引，索引生效<br><br><br>/**<br>6-数据分布影响<br>·如果MySQL评估使用索引比全表更慢，则放弃索引，大部分数据都符合条件时会出现这种情况<br>*/<br><br>explain<br>select *<br>from tb_user<br>where phone &gt; &#x27;0&#x27;;<br>-- 所有电话号码都大于0，使用全表扫描<br><br>-- 使用了索引，具体使用索引还是不使用索引取决表中的数据，符合条件的数据多-&gt;不用，少-&gt;用<br>explain<br>select *<br>from tb_user<br>where profession is null;<br><br>-- 未使用索引<br>explain<br>select *<br>from tb_user<br>where profession is not null;<br><br><br><br>-- SQL提示:是优化数据库的一个重要手段，就是在sql语句中加入一些人为的提示达到优化操作的目的<br>-- 查询一个字段时，如果同时存在单列索引和联合索引，默认使用联合索引<br><br>-- profession有两个索引，默认使用的是联合索引<br>explain<br>select *<br>from tb_user<br>where profession = &#x27;软件工程&#x27;;<br><br>-- use index 建议MySQL使用这个索引，至于用不用，取决于MySQL<br>explain<br>select *<br>from tb_user use index (idx_user_pro)<br>where profession = &#x27;软件工程&#x27;;<br><br>-- ignore index 忽略索引，指定不会使用该索引<br>explain<br>select *<br>from tb_user ignore index (idx_user_pro)<br>where profession = &#x27;软件工程&#x27;;<br><br>-- force index 强制使用，指定必须使用该索引,use可能MySQL并不接受，force强制MySQL使用<br><br>-- ---------------------------------------------------------------<br><br></code></pre></td></tr></table></figure>



<h2 id="2、SQL优化"><a href="#2、SQL优化" class="headerlink" title="2、SQL优化"></a>2、SQL优化</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><code class="hljs mysql">-- SQL优化<br><br>-- 1、插入优化:<br>-- 批量插入<br>-- 手动控制事务<br>-- 主键顺序插入<br>-- load指令<br><br>select @@local_infile;<br>set global local_infile = 1;<br><br>load data local infile &#x27;D:/Edge下载/进阶篇/相关SQL脚本/load_user_100w_sort.sql&#x27; into table tb_user fields terminated by &#x27;,&#x27; lines terminated by &#x27;\n&#x27;;<br><br>-- 2、主键优化：<br>-- 尽量降低主键的长度<br>-- 插入数据时，尽量使用顺序插入<br>-- 尽量不要使用UUID或者其他自然主键<br>-- 尽量不对主键进行修改<br><br>-- 3、order by 优化：<br>-- using filesort:效率低<br>-- using index:效率高<br>show index from  tb_user; -- Collation:索引的顺序，A-&gt;升序，D-&gt;降序<br><br>explain select age,phone from tb_user order by age,phone;<br><br>-- 创建age和phone字段的一个联合索引,根据索引查询，结果不需要再进行排序<br>create index idx_user_age_phone on tb_user(age,phone);<br><br>-- 两个条件都是倒序，使用index倒序扫描 Backward index scan; Using index<br>explain select age,phone from tb_user order by age desc,phone desc ;<br><br>-- 先对phone排序，再根据age排序,不符合最左前缀法则，Using index; Using filesort<br>explain select age,phone from tb_user order by phone,age;<br><br>-- 先对age升序，再对phone降序排序<br>explain select age,phone from tb_user order by age,phone desc;<br><br>-- 优化：创建age升序phone降序的索引(默认是升序)<br>create index idx_user_age_phone_ad on tb_user(age,phone desc);<br><br>-- 尽量避免使用select*,否则需要所有字段都建立了联合索引才能走索引，否则就是filesort<br>-- 不可避免使用filesort时，可以适当增大排序文件缓冲区大小<br><br>-- limit 优化<br>select *<br>from tb_user<br>limit 900000,10;<br><br>-- 覆盖索引加子查询的形式<br>select t.*<br>from tb_user t,<br>(select id from tb_user order by id limit 900000,10) e<br>where t.id = e.id;<br><br><br>-- count()优化<br>-- 效率 count(*) ≈ count(1) &gt; count(主键) &gt; count(字段)<br>select count(*)from tb_user;<br>select count(id)from tb_user;<br>select count(1)from tb_user;<br>select count(username) from tb_user;<br><br>-- update 优化<br>-- update更新的数据最好有索引，否则执行update语句时行锁会升级为表锁，并发性能降低<br></code></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/02/wuJknzxaFigDSdL.gif" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/02/wuJknzxaFigDSdL.gif" title="头像" alt="头像"></a><div class="post-copyright__author_name">caolibin</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://clibin.gitee.io/2023/07/28/mysql/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('https://clibin.gitee.io/2023/07/28/mysql/')">mysql</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://clibin.gitee.io/2023/07/28/mysql/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=mysql&amp;url=https://clibin.gitee.io/2023/07/28/mysql/&amp;pic=https://img2.imgtp.com/2024/04/26/wBGeLSLD.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://clibin.gitee.io" target="_blank">学海无涯</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>数据库<span class="tagsPageCount">2</span></a><a class="post-meta__box__tags" href="/tags/mysql/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>mysql<span class="tagsPageCount">3</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://files.codelife.cc/wallhaven/full/mp/wallhaven-mpjj91.jpg?x-oss-process=image/resize,limit_0,m_fill,w_2560,h_1440/quality,Q_92/format,webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/07/28/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img2.imgtp.com/2024/04/26/70AimvgV.jpeg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">操作系统</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/31/linux%E5%91%BD%E4%BB%A4/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img2.imgtp.com/2024/04/26/vSmYRYLp.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">linux命令</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2023/08/31/Redis/" title="Redis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img2.imgtp.com/2024/04/26/uXIQ2MgX.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-08-31</div><div class="title">Redis</div></div></a></div><div><a href="/2023/10/14/mybatis/" title="mybatis"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/09/ZuWeizVmJ3DNOgq.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-10-14</div><div class="title">mybatis</div></div></a></div><div><a href="/2023/08/31/mybatis-plus/" title="mybatis-plus"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img2.imgtp.com/2024/04/26/dAtgB1Oy.jpeg" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2023-08-31</div><div class="title">mybatis-plus</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i><span> 评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left: 4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/02/wuJknzxaFigDSdL.gif" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2021/01/15/1bc13fa6b2808.png" alt="status"/></div></div><div class="author-info__description"><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">这有关于<b style="color:#fff">产品、设计、开发</b>相关的问题和看法，还有<b style="color:#fff">文章翻译</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:0.6rem 0;text-align:justify;color:rgba(255, 255, 255, 0.8);">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">caolibin</h1><div class="author-info__desc"></div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/caolib" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/441126797" target="_blank" title="BiliBili"></a></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#MySQL"><span class="toc-number">1.</span> <span class="toc-text">MySQL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A7%E8%A1%8C%E7%BC%96%E5%86%99%E9%A1%BA%E5%BA%8F"><span class="toc-number">1.1.</span> <span class="toc-text">执行编写顺序</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%95%B0%E6%8D%AE%E5%AE%9A%E4%B9%89%E8%AF%AD%E8%A8%80DDL"><span class="toc-number">2.</span> <span class="toc-text">一、数据定义语言DDL</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">2.1.</span> <span class="toc-text">1、数据库操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">2.2.</span> <span class="toc-text">2、表操作</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81-DML%EF%BC%88%E5%A2%9E%E5%88%A0%E6%94%B9%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">二、 DML（增删改）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#insert-update-delete"><span class="toc-number">3.1.</span> <span class="toc-text">insert update delete</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81DQL%EF%BC%88%E6%9F%A5%EF%BC%89"><span class="toc-number">4.</span> <span class="toc-text">三、DQL（查）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81select-from"><span class="toc-number">4.1.</span> <span class="toc-text">1、select from</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81where"><span class="toc-number">4.2.</span> <span class="toc-text">2、where</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81count%E3%80%81max%E3%80%81group"><span class="toc-number">4.3.</span> <span class="toc-text">3、count、max、group</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81order-by"><span class="toc-number">4.4.</span> <span class="toc-text">4、order by</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E6%A1%88%E4%BE%8B"><span class="toc-number">4.5.</span> <span class="toc-text">5、案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81-DCL"><span class="toc-number">5.</span> <span class="toc-text">四、 DCL</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81-%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">五、 函数</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0"><span class="toc-number">6.1.</span> <span class="toc-text">1、字符串函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0"><span class="toc-number">6.2.</span> <span class="toc-text">2、数值函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E6%97%A5%E6%9C%9F%E5%87%BD%E6%95%B0"><span class="toc-number">6.3.</span> <span class="toc-text">3、日期函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6%E5%87%BD%E6%95%B0"><span class="toc-number">6.4.</span> <span class="toc-text">4、流程控制函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B"><span class="toc-number">6.4.1.</span> <span class="toc-text">案例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.</span> <span class="toc-text">六、约束</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E5%9F%BA%E7%A1%80%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.1.</span> <span class="toc-text">1、基础约束</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%A4%96%E9%94%AE%E7%BA%A6%E6%9D%9F"><span class="toc-number">7.2.</span> <span class="toc-text">2、外键约束</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%A2%9E%E3%80%81%E5%88%A0%E5%A4%96%E9%94%AE"><span class="toc-number">7.2.1.</span> <span class="toc-text">1、增、删外键</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%88%A0%E9%99%A4%E3%80%81%E6%9B%B4%E6%96%B0%E8%A1%8C%E4%B8%BA"><span class="toc-number">7.2.2.</span> <span class="toc-text">2、删除、更新行为</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.</span> <span class="toc-text">七、多表查询</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E6%A6%82%E8%BF%B0"><span class="toc-number">8.1.</span> <span class="toc-text">1、概述</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E8%BF%9E%E6%8E%A5%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.2.</span> <span class="toc-text">2、连接查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E8%BF%9E%E6%8E%A5"><span class="toc-number">8.2.1.</span> <span class="toc-text">内连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%96%E8%BF%9E%E6%8E%A5"><span class="toc-number">8.2.2.</span> <span class="toc-text">外连接</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E8%BF%9E%E6%8E%A5"><span class="toc-number">8.2.3.</span> <span class="toc-text">自连接</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#union%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.3.</span> <span class="toc-text">union查询</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.</span> <span class="toc-text">3、子查询</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%87%E9%87%8F%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.1.</span> <span class="toc-text">标量子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.2.</span> <span class="toc-text">列子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%8C%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.3.</span> <span class="toc-text">行子查询</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="toc-number">8.4.4.</span> <span class="toc-text">表子查询</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2%E6%A1%88%E4%BE%8B"><span class="toc-number">8.5.</span> <span class="toc-text">4、多表查询案例</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E4%BA%8B%E5%8A%A1"><span class="toc-number">9.</span> <span class="toc-text">八、事务</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E4%BA%8B%E5%8A%A1%E7%AE%80%E4%BB%8B"><span class="toc-number">9.1.</span> <span class="toc-text">1、事务简介</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E4%BA%8B%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="toc-number">9.2.</span> <span class="toc-text">2、事务操作</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%9B%9B%E5%A4%A7%E7%89%B9%E6%80%A7%EF%BC%88ACID%EF%BC%89"><span class="toc-number">9.3.</span> <span class="toc-text">3、事务的四大特性（ACID）</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81%E5%B9%B6%E5%8F%91%E4%BA%8B%E5%8A%A1%E9%97%AE%E9%A2%98"><span class="toc-number">9.4.</span> <span class="toc-text">4、并发事务问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB"><span class="toc-number">9.5.</span> <span class="toc-text">5、隔离级别</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B9%9D%E3%80%81JDBC"><span class="toc-number">10.</span> <span class="toc-text">九、JDBC</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81jdbc7%E6%AD%A5%E7%BC%96%E7%A8%8B"><span class="toc-number">10.1.</span> <span class="toc-text">1、jdbc7步编程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81DriverManager"><span class="toc-number">10.2.</span> <span class="toc-text">2、DriverManager</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3%E3%80%81Connection"><span class="toc-number">10.3.</span> <span class="toc-text">3、Connection</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4%E3%80%81Statement"><span class="toc-number">10.4.</span> <span class="toc-text">4、Statement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5%E3%80%81ResultSet"><span class="toc-number">10.5.</span> <span class="toc-text">5、ResultSet</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6%E3%80%81%E7%94%A8%E6%88%B7%E7%99%BB%E9%99%86"><span class="toc-number">10.6.</span> <span class="toc-text">6、用户登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7%E3%80%81PrepareStatement"><span class="toc-number">10.7.</span> <span class="toc-text">7、PrepareStatement</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8%E3%80%81Druid%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0"><span class="toc-number">10.8.</span> <span class="toc-text">8、Druid数据库连接池</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8D%81%E3%80%81%E8%BF%9B%E9%98%B6"><span class="toc-number">11.</span> <span class="toc-text">十、进阶</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E3%80%81%E7%B4%A2%E5%BC%95"><span class="toc-number">11.1.</span> <span class="toc-text">1、索引</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81SQL%E4%BC%98%E5%8C%96"><span class="toc-number">11.2.</span> <span class="toc-text">2、SQL优化</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/03/27/npm-yarn/" title="npm、yarn 包管理器"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.codelife.cc/wallhaven/full/mp/wallhaven-mpjj91.jpg?x-oss-process=image/resize,limit_0,m_fill,w_2560,h_1440/quality,Q_92/format,webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="npm、yarn 包管理器"/></a><div class="content"><a class="title" href="/2024/03/27/npm-yarn/" title="npm、yarn 包管理器">npm、yarn 包管理器</a><time datetime="2024-03-27T05:37:44.000Z" title="发表于 2024-03-27 13:37:44">2024-03-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/25/git/" title="git版本控制系统"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://files.codelife.cc/wallhaven/full/42/wallhaven-42z9em.jpg?x-oss-process=image/resize,limit_0,m_fill,w_2560,h_1440/quality,Q_92/format,webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="git版本控制系统"/></a><div class="content"><a class="title" href="/2024/03/25/git/" title="git版本控制系统">git版本控制系统</a><time datetime="2024-03-25T13:45:03.000Z" title="发表于 2024-03-25 21:45:03">2024-03-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/19/windows%E5%AE%9A%E6%97%B6%E5%85%B3%E6%9C%BA/" title="windows定时关机"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://img2.imgtp.com/2024/04/26/zzTq9wAc.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="windows定时关机"/></a><div class="content"><a class="title" href="/2024/03/19/windows%E5%AE%9A%E6%97%B6%E5%85%B3%E6%9C%BA/" title="windows定时关机">windows定时关机</a><time datetime="2024-03-19T14:28:39.000Z" title="发表于 2024-03-19 22:28:39">2024-03-19</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/18/apifox%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" title="apifox测试工具"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/09/MgYqOejQcICpFsP.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="apifox测试工具"/></a><div class="content"><a class="title" href="/2024/03/18/apifox%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" title="apifox测试工具">apifox测试工具</a><time datetime="2024-03-18T14:20:23.000Z" title="发表于 2024-03-18 22:20:23">2024-03-18</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/03/17/springcloud%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/" title="springcloud从入门到放弃"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://s2.loli.net/2024/06/07/HiWVoEZNrKnb4va.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="springcloud从入门到放弃"/></a><div class="content"><a class="title" href="/2024/03/17/springcloud%E4%BB%8E%E5%85%A5%E9%97%A8%E5%88%B0%E6%94%BE%E5%BC%83/" title="springcloud从入门到放弃">springcloud从入门到放弃</a><time datetime="2024-03-17T14:22:28.000Z" title="发表于 2024-03-17 22:22:28">2024-03-17</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="workboard"><img class="workSituationImg boardsign" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-上班摸鱼中.svg" alt="距离月入25k也就还差一个大佬带我~" title="距离月入25k也就还差一个大佬带我~"/><div id="runtimeTextTip"></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="博客框架为Hexo_v5.4.0" title="博客框架为Hexo_v5.4.0"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Frame-Hexo.svg" alt="博客框架为Hexo_v5.4.0"/></a><a class="github-badge" target="_blank" href="https://blog.anheyu.com/" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.9/img/Theme-AnZhiYu-2E67D3.svg" alt="本站使用AnZhiYu主题"/></a><a class="github-badge" target="_blank" href="https://github.com/caolib/caolib.github.io" style="margin-inline:5px" data-title="本站项目由Github托管" title="本站项目由Github托管"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@2.1.5/img/badge/Source-Github.svg" alt="本站项目由Github托管"/></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2023 - 2024 By <a class="footer-bar-link" href="/" title="caolibin" target="_blank">caolibin</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">22</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">28</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">9</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">其他线路</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://clb.pages.dev" title="cloudflare"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/cloudflare.svg" alt="cloudflare"/><span class="back-menu-item-text">cloudflare</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.netlify.app" title="netlify"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/netlify.svg" alt="netlify"/><span class="back-menu-item-text">netlify</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.github.io" title="github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/github.svg" alt="github"/><span class="back-menu-item-text">github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://caolib.vercel.app" title="vercel"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/vercel.svg" alt="vercel"/><span class="back-menu-item-text">vercel</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">我</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://github.com/caolib" title="github"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/github.svg" alt="github"/><span class="back-menu-item-text">github</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://gitee.com/clibin" title="gitee"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/gitee.svg" alt="gitee"/><span class="back-menu-item-text">gitee</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size: 0.9em;"></i><span> 追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size: 0.9em;"></i><span> 小空调</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/NOSQL/" style="font-size: 0.88rem;">NOSQL<sup>1</sup></a><a href="/tags/apifox/" style="font-size: 0.88rem;">apifox<sup>1</sup></a><a href="/tags/axios/" style="font-size: 0.88rem;">axios<sup>1</sup></a><a href="/tags/c/" style="font-size: 0.88rem;">c++<sup>1</sup></a><a href="/tags/everything/" style="font-size: 0.88rem;">everything<sup>1</sup></a><a href="/tags/gateway/" style="font-size: 0.88rem;">gateway<sup>1</sup></a><a href="/tags/git/" style="font-size: 0.88rem;">git<sup>1</sup></a><a href="/tags/java/" style="font-size: 0.88rem; font-weight: 500; color: var(--anzhiyu-lighttext)">java<sup>2</sup></a><a href="/tags/jwt/" style="font-size: 0.88rem;">jwt<sup>1</sup></a><a href="/tags/linux/" style="font-size: 0.88rem;">linux<sup>1</sup></a><a href="/tags/markdown/" style="font-size: 0.88rem;">markdown<sup>1</sup></a><a href="/tags/mybatis/" style="font-size: 0.88rem;">mybatis<sup>2</sup></a><a href="/tags/mysql/" style="font-size: 0.88rem;">mysql<sup>3</sup></a><a href="/tags/nacos/" style="font-size: 0.88rem;">nacos<sup>1</sup></a><a href="/tags/npm/" style="font-size: 0.88rem;">npm<sup>1</sup></a><a href="/tags/os/" style="font-size: 0.88rem;">os<sup>1</sup></a><a href="/tags/pinia/" style="font-size: 0.88rem;">pinia<sup>1</sup></a><a href="/tags/redis/" style="font-size: 0.88rem;">redis<sup>2</sup></a><a href="/tags/shields/" style="font-size: 0.88rem;">shields<sup>1</sup></a><a href="/tags/springboot/" style="font-size: 0.88rem; font-weight: 500; color: var(--anzhiyu-lighttext)">springboot<sup>2</sup></a><a href="/tags/springcloud/" style="font-size: 0.88rem; font-weight: 500; color: var(--anzhiyu-lighttext)">springcloud<sup>2</sup></a><a href="/tags/windows/" style="font-size: 0.88rem;">windows<sup>1</sup></a><a href="/tags/%E6%90%9C%E7%B4%A2/" style="font-size: 0.88rem;">搜索<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size: 0.88rem; font-weight: 500; color: var(--anzhiyu-lighttext)">数据库<sup>2</sup></a><a href="/tags/%E6%A0%87%E7%AD%BE/" style="font-size: 0.88rem;">标签<sup>1</sup></a><a href="/tags/%E6%B5%8B%E8%AF%95/" style="font-size: 0.88rem;">测试<sup>1</sup></a><a href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/" style="font-size: 0.88rem;">计算机网络<sup>1</sup></a><a href="/tags/%E9%82%AE%E4%BB%B6/" style="font-size: 0.88rem;">邮件<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="anzhiyufont anzhiyu-icon-comments"></i></a><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="9516665896" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="algolia-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="search-wrap"><div id="algolia-search-input"></div><hr/><div id="algolia-search-results"><div id="algolia-hits"><a class="tag-list" href="/tags/springboot" title="springboot">springboot</a><a class="tag-list" href="/tags/springcloud" title="springcloud">springcloud</a><a class="tag-list" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C" title="计算机网络">计算机网络</a><a class="tag-list" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93" title="数据库">数据库</a></div><div id="algolia-pagination"></div><div id="algolia-info"><div class="algolia-stats"></div><div class="algolia-poweredBy"></div></div></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/#/my/m/music/playlist?id=9516665896&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script async="async">(function () {
  var grt = new Date("12/26/2023 16:20:00"); //设置网站上线时间
  var now = new Date();
  var dnum;
  var hnum;
  var mnum;
  var snum;
  var nowHour;

  // 计算并更新天数、小时数、分钟数和秒数
  function updateTime() {
    now = new Date(); // 更新 now 的值
    nowHour = now.getHours(); // 更新 nowHour 的值
    var days = (now - grt) / 1000 / 60 / 60 / 24;
    dnum = Math.floor(days);
    var hours = (now - grt) / 1000 / 60 / 60 - 24 * dnum;
    hnum = Math.floor(hours);
    if (String(hnum).length == 1) {
      hnum = "0" + hnum;
    }
    var minutes = (now - grt) / 1000 / 60 - 24 * 60 * dnum - 60 * hnum;
    mnum = Math.floor(minutes);
    if (String(mnum).length == 1) {
      mnum = "0" + mnum;
    }
    var seconds = (now - grt) / 1000 - 24 * 60 * 60 * dnum - 60 * 60 * hnum - 60 * mnum;
    snum = Math.round(seconds);
    if (String(snum).length == 1) {
      snum = "0" + snum;
    }
  }

  // 更新网页中显示的网站运行时间
  function updateHtml() {
    const footer = document.getElementById("footer");
    if (!footer) return
    let currentTimeHtml = "";
    if (nowHour < 18 && nowHour >= 9) {
      // 如果是上班时间，默认就是"安知鱼-上班摸鱼中.svg"图片，不需要更改
      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    } else {
      // 如果是下班时间，插入"安知鱼-下班啦.svg"图片
      let img = document.querySelector("#workboard .workSituationImg");
      if (img != null) {
        img.src = "https://npm.elemecdn.com/anzhiyu-blog@2.0.4/img/badge/安知鱼-下班啦.svg";
        img.title = "下班了就该开开心心的玩耍，嘿嘿~";
        img.alt = "下班了就该开开心心的玩耍，嘿嘿~";
      }

      currentTimeHtml = `本站居然运行了 ${dnum} 天<span id='runtime'> ${hnum} 小时 ${mnum} 分 ${snum} 秒 </span><i class='anzhiyufont anzhiyu-icon-heartbeat' style='color:red'></i>`;
    }

    if (document.getElementById("runtimeTextTip")) {
      document.getElementById("runtimeTextTip").innerHTML = currentTimeHtml;
    }
  }

  setInterval(() => {
    updateTime();
    updateHtml();
  }, 1000);
})();</script><script src="https://cdn.cbd.int/algoliasearch@4.18.0/dist/algoliasearch-lite.umd.js"></script><script src="https://cdn.cbd.int/instantsearch.js@4.60.0/dist/instantsearch.production.min.js"></script><script src="/js/search/algolia.js"></script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.cbd.int/katex@0.16.0/dist/katex.min.css"><script src="https://cdn.cbd.int/katex@0.16.0/dist/contrib/copy-tex.min.js"></script><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    anzhiyu.wrap(item, 'div', { class: 'katex-wrap'})
  })
})()</script><script>(() => {
  const init = () => {
    twikoo.init(Object.assign({
      el: '#twikoo-wrap',
      envId: 'https://clibin-twikoo-comments.hf.space',
      region: '',
      onCommentLoaded: () => {
        anzhiyu.loadLightbox(document.querySelectorAll('#twikoo .tk-content img:not(.tk-owo-emotion)'))
      }
    }, null))
  }

  const loadTwikoo = () => {
    if (typeof twikoo === 'object') setTimeout(runFn,0)
    else getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runFn)
  }

  const getCount = () => {
    const countELement = document.getElementById('twikoo-count')
    if(!countELement) return
    twikoo.getCommentsCount({
      envId: 'https://clibin-twikoo-comments.hf.space',
      region: '',
      urls: [window.location.pathname],
      includeReply: false
    }).then(res => {
      countELement.textContent = res[0].count
    }).catch(err => {
      console.error(err)
    })
  }

  const runFn = () => {
    init();
    GLOBAL_CONFIG_SITE.isPost && getCount()
  }

  if ('Twikoo' === 'Twikoo' || !true) {
    if (true) anzhiyu.loadComment(document.getElementById('twikoo-wrap'), loadTwikoo)
    else {
      loadTwikoo()
    }
  } else {
    window.loadOtherComment = loadTwikoo
  }
})()</script><input type="hidden" name="page-type" id="page-type" value="post"><script async src="/js/anzhiyu/comment_barrage.js"></script></div><script>window.addEventListener('load', () => {
  const changeContent = (content) => {
    if (content === '') return content

    content = content.replace(/<img.*?src="(.*?)"?[^\>]+>/ig, '[图片]') // replace image link
    content = content.replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi, '[链接]') // replace url
    content = content.replace(/<pre><code>.*?<\/pre>/gi, '[代码]') // replace code
    content = content.replace(/<[^>]+>/g,"") // remove html tag

    if (content.length > 150) {
      content = content.substring(0,150) + '...'
    }
    return content
  }

  const getComment = () => {
    const runTwikoo = () => {
      twikoo.getRecentComments({
        envId: 'https://clibin-twikoo-comments.hf.space',
        region: '',
        pageSize: 6,
        includeReply: true
      }).then(function (res) {
        const twikooArray = res.map(e => {
          return {
            'content': changeContent(e.comment),
            'avatar': e.avatar,
            'nick': e.nick,
            'url': e.url + '#' + e.id,
            'date': new Date(e.created).toISOString()
          }
        })

        saveToLocal.set('twikoo-newest-comments', JSON.stringify(twikooArray), 10/(60*24))
        generateHtml(twikooArray)
      }).catch(function (err) {
        const $dom = document.querySelector('#card-newest-comments .aside-list')
        $dom.textContent= "无法获取评论，请确认相关配置是否正确"
      })
    }

    if (typeof twikoo === 'object') {
      runTwikoo()
    } else {
      getScript('https://cdn.cbd.int/twikoo@1.6.25/dist/twikoo.all.min.js').then(runTwikoo)
    }
  }

  const generateHtml = array => {
    let result = ''

    if (array.length) {
      for (let i = 0; i < array.length; i++) {
        result += '<div class=\'aside-list-item\'>'

        if (true) {
          const name = 'data-lazy-src'
          result += `<a href='${array[i].url}' class='thumbnail'><img ${name}='${array[i].avatar}' alt='${array[i].nick}'><div class='name'><span>${array[i].nick} </span></div></a>`
        }
        
        result += `<div class='content'>
        <a class='comment' href='${array[i].url}' title='${array[i].content}'>${array[i].content}</a>
        <time datetime="${array[i].date}">${anzhiyu.diffDate(array[i].date, true)}</time></div>
        </div>`
      }
    } else {
      result += '没有评论'
    }

    let $dom = document.querySelector('#card-newest-comments .aside-list')
    $dom && ($dom.innerHTML= result)
    window.lazyLoadInstance && window.lazyLoadInstance.update()
    window.pjax && window.pjax.refresh($dom)
  }

  const newestCommentInit = () => {
    if (document.querySelector('#card-newest-comments .aside-list')) {
      const data = saveToLocal.get('twikoo-newest-comments')
      if (data) {
        generateHtml(JSON.parse(data))
      } else {
        getComment()
      }
    }
  }

  newestCommentInit()
  document.addEventListener('pjax:complete', newestCommentInit)
})</script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><div class="aplayer no-destroy" data-id="8400298436" data-server="netease" data-type="playlist" data-fixed="true" data-autoplay="false" data-mini='true'> </div><script src="https://cdn.jsdelivr.net/npm/@docsearch/js@3"></script><script type="text/javascript">docsearch({appId:5ZERDAEVZ8, apiKey:a026e88a33a21c12f851e20db56e4d88,indexName:tankingcaoio,insights:true,container:div, debug:false});</script><script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script><script>LA.init({id:"3IEsC7dmGhpF8yGN",ck:"3IEsC7dmGhpF8yGN"})</script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["meta[property=\"og:image\"]","meta[property=\"og:title\"]","meta[property=\"og:url\"]","meta[property=\"og:type\"]","meta[property=\"og:site_name\"]","meta[property=\"og:description\"]","head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/haruto.model.json"},"display":{"position":"right","width":80,"height":160},"mobile":{"show":false},"react":{"opacity":0.7},"log":false});</script></body></html>